0966d4e0effcd363c9cd1fe1d922ff0b
"use strict";
/**
 * OpenMake LLM E2E 테스트
 * 주요 사용자 플로우 테스트
 */
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const test_1 = require("@playwright/test");
test_1.test.describe('API 헬스체크', () => {
    (0, test_1.test)('서버 상태 확인 (GET /health)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/health');
        (0, test_1.expect)(response.status()).toBe(200);
        const body = yield response.json();
        (0, test_1.expect)(body.status).toBe('ok');
    }));
    (0, test_1.test)('준비 상태 확인 (GET /ready)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/ready');
        (0, test_1.expect)(response.status()).toBe(200);
    }));
});
test_1.test.describe('API 문서', () => {
    (0, test_1.test)('Swagger UI 접근 가능 (GET /api-docs)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ page }) {
        yield page.goto('/api-docs');
        yield (0, test_1.expect)(page.locator('#swagger-ui')).toBeVisible();
    }));
    (0, test_1.test)('OpenAPI 스펙 조회 (GET /api/openapi.json)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/api/openapi.json');
        (0, test_1.expect)(response.status()).toBe(200);
        const spec = yield response.json();
        (0, test_1.expect)(spec.openapi).toMatch(/^3\./);
        (0, test_1.expect)(spec.info.title).toBeTruthy();
    }));
});
test_1.test.describe('에이전트 API', () => {
    (0, test_1.test)('에이전트 목록 조회 (GET /api/agents)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/api/agents');
        (0, test_1.expect)(response.status()).toBe(200);
        const body = yield response.json();
        (0, test_1.expect)(body.agents).toBeDefined();
        (0, test_1.expect)(Array.isArray(body.agents)).toBe(true);
        (0, test_1.expect)(body.total).toBeGreaterThan(0);
    }));
    (0, test_1.test)('에이전트 메트릭 조회 (GET /api/agents/metrics)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/api/agents/metrics');
        (0, test_1.expect)(response.status()).toBe(200);
        const body = yield response.json();
        (0, test_1.expect)(body.success).toBe(true);
        (0, test_1.expect)(body.metrics).toBeDefined();
    }));
});
test_1.test.describe('클러스터 API', () => {
    (0, test_1.test)('클러스터 상태 조회 (GET /api/cluster/status)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/api/cluster/status');
        (0, test_1.expect)(response.status()).toBe(200);
        const body = yield response.json();
        (0, test_1.expect)(body.nodes).toBeDefined();
    }));
});
test_1.test.describe('MCP API', () => {
    (0, test_1.test)('MCP 설정 조회 (GET /api/mcp/settings)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/api/mcp/settings');
        (0, test_1.expect)(response.status()).toBe(200);
        const body = yield response.json();
        (0, test_1.expect)(body.settings).toBeDefined();
    }));
    (0, test_1.test)('MCP 도구 목록 조회 (GET /api/mcp/tools)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/api/mcp/tools');
        (0, test_1.expect)(response.status()).toBe(200);
        const body = yield response.json();
        (0, test_1.expect)(body.tools).toBeDefined();
    }));
});
test_1.test.describe('메인 페이지 UI', () => {
    (0, test_1.test)('홈페이지 로드', (_a) => __awaiter(void 0, [_a], void 0, function* ({ page }) {
        yield page.goto('/');
        yield (0, test_1.expect)(page).toHaveTitle(/OpenMake|AI|LLM/i);
    }));
    (0, test_1.test)('채팅 인터페이스 존재 확인', (_a) => __awaiter(void 0, [_a], void 0, function* ({ page }) {
        yield page.goto('/');
        // 채팅 입력 영역 존재 확인 (다양한 선택자 시도)
        const chatInput = page.locator('textarea, input[type="text"], [contenteditable="true"]').first();
        yield (0, test_1.expect)(chatInput).toBeVisible({ timeout: 10000 });
    }));
});
test_1.test.describe('시스템 API', () => {
    (0, test_1.test)('사용량 통계 조회 (GET /api/usage)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/api/usage');
        (0, test_1.expect)(response.status()).toBe(200);
        const body = yield response.json();
        (0, test_1.expect)(body.success).toBe(true);
    }));
    (0, test_1.test)('모델 정보 조회 (GET /api/model)', (_a) => __awaiter(void 0, [_a], void 0, function* ({ request }) {
        const response = yield request.get('/api/model');
        (0, test_1.expect)(response.status()).toBe(200);
        const body = yield response.json();
        (0, test_1.expect)(body.model).toBeDefined();
    }));
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1ZvbHVtZXMvTUFDX0FQUC9vcGVubWFrZV9sbG0vdGVzdHMvZTJlL21haW4tZmxvdy5zcGVjLnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7O0dBR0c7Ozs7Ozs7Ozs7O0FBRUgsMkNBQWdEO0FBRWhELFdBQUksQ0FBQyxRQUFRLENBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRTtJQUMzQixJQUFBLFdBQUksRUFBQyx3QkFBd0IsRUFBRSxLQUFvQixFQUFFLDRDQUFmLEVBQUUsT0FBTyxFQUFFO1FBQzdDLE1BQU0sUUFBUSxHQUFHLE1BQU0sT0FBTyxDQUFDLEdBQUcsQ0FBQyxTQUFTLENBQUMsQ0FBQztRQUM5QyxJQUFBLGFBQU0sRUFBQyxRQUFRLENBQUMsTUFBTSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLENBQUM7UUFFcEMsTUFBTSxJQUFJLEdBQUcsTUFBTSxRQUFRLENBQUMsSUFBSSxFQUFFLENBQUM7UUFDbkMsSUFBQSxhQUFNLEVBQUMsSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNuQyxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBRUgsSUFBQSxXQUFJLEVBQUMsdUJBQXVCLEVBQUUsS0FBb0IsRUFBRSw0Q0FBZixFQUFFLE9BQU8sRUFBRTtRQUM1QyxNQUFNLFFBQVEsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDN0MsSUFBQSxhQUFNLEVBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO0lBQ3hDLENBQUMsQ0FBQSxDQUFDLENBQUM7QUFDUCxDQUFDLENBQUMsQ0FBQztBQUVILFdBQUksQ0FBQyxRQUFRLENBQUMsUUFBUSxFQUFFLEdBQUcsRUFBRTtJQUN6QixJQUFBLFdBQUksRUFBQyxrQ0FBa0MsRUFBRSxLQUFpQixFQUFFLDRDQUFaLEVBQUUsSUFBSSxFQUFFO1FBQ3BELE1BQU0sSUFBSSxDQUFDLElBQUksQ0FBQyxX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SSxDQUFDLE9BQU8sQ0FBQyxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQztJQUNwQyxDQUFDLENBQUEsQ0FBQyxDQUFDO0lBRUgsSUFBQSxXQUFJLEVBQUMsMkJBQTJCLEVBQUUsS0FBb0IsRUFBRSw0Q0FBZixFQUFFLE9BQU8sRUFBRTtRQUNoRCxNQUFNLFFBQVEsR0FBRyxNQUFNLE9BQU8sQ0FBQyxHQUFHLENBQUMsWUFBWSxDQUFDLENBQUM7UUFDakQsSUFBQSxhQUFNLEVBQUMsUUFBUSxDQUFDLE1BQU0sRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDO1FBRXBDLE1BQU0sSUFBSSxHQUFHLE1BQU0sUUFBUSxDQUFDLElBQUksRUFBRSxDQUFDO1FBQ25DLElBQUEsYUFBTSxFQUFDLElBQUksQ0FBQyxLQUFLLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztJQUNyQyxDQUFDLENBQUEsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1ZvbHVtZXMvTUFDX0FQUC9vcGVubWFrZV9sbG0vdGVzdHMvZTJlL21haW4tZmxvdy5zcGVjLnRzIl0sInNvdXJjZXNDb250ZW50IjpbIi8qKlxuICogT3Blbk1ha2UgTExNIEUyRSDthYzsiqTtirhcbiAqIOyjvOyalCDsgqzsmqnsnpAg7ZSM66Gc7JqwIO2FjOyKpO2KuFxuICovXG5cbmltcG9ydCB7IHRlc3QsIGV4cGVjdCB9IGZyb20gJ0BwbGF5d3JpZ2h0L3Rlc3QnO1xuXG50ZXN0LmRlc2NyaWJlKCdBUEkg7Zes7Iqk7LK07YGsJywgKCkgPT4ge1xuICAgIHRlc3QoJ+yEnOuyhCDsg4Htg5wg7ZmV7J24IChHRVQgL2hlYWx0aCknLCBhc3luYyAoeyByZXF1ZXN0IH0pID0+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0LmdldCgnL2hlYWx0aCcpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKCkpLnRvQmUoMjAwKTtcblxuICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBleHBlY3QoYm9keS5zdGF0dXMpLnRvQmUoJ29rJyk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCfspIDruYQg7IOB7YOcIO2ZleyduCAoR0VUIC9yZWFkeSknLCBhc3luYyAoeyByZXF1ZXN0IH0pID0+IHtcbiAgICAgICAgY29uc3QgcmVzcG9uc2UgPSBhd2FpdCByZXF1ZXN0LmdldCgnL3JlYWR5Jyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMoKSkudG9CZSgyMDApO1xuICAgIH0pO1xufSk7XG5cbnRlc3QuZGVzY3JpYmUoJ0FQSSDrrLjshJwnLCAoKSA9PiB7XG4gICAgdGVzdCgnU3dhZ2dlciBVSSDsoJHqt7wg6rCA64qlIChHRVQgL2FwaS1kb2NzKScsIGFzeW5jICh7IHBhZ2UgfSkgPT4ge1xuICAgICAgICBhd2FpdCBwYWdlLmdvdG8oJy9hcGktZG9jcycpO1xuICAgICAgICBhd2FpdCBleHBlY3QocGFnZS5sb2NhdG9yKCcjc3dhZ2dlci11aScpKS50b0JlVmlzaWJsZSgpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgnT3BlbkFQSSDsiqTtjpkg7KGw7ZqMIChHRVQgL2FwaS9vcGVuYXBpLmpzb24pJywgYXN5bmMgKHsgcmVxdWVzdCB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdC5nZXQoJy9hcGkvb3BlbmFwaS5qc29uJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMoKSkudG9CZSgyMDApO1xuXG4gICAgICAgIGNvbnN0IHNwZWMgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGV4cGVjdChzcGVjLm9wZW5hcGkpLnRvTWF0Y2goL14zXFwuLyk7XG4gICAgICAgIGV4cGVjdChzcGVjLmluZm8udGl0bGUpLnRvQmVUcnV0aHkoKTtcbiAgICB9KTtcbn0pO1xuXG50ZXN0LmRlc2NyaWJlKCfsl5DsnbTsoITtirggQVBJJywgKCkgPT4ge1xuICAgIHRlc3QoJ+yXkOydtOyghO2KuCDrqqnroZ0g7KGw7ZqMIChHRVQgL2FwaS9hZ2VudHMpJywgYXN5bmMgKHsgcmVxdWVzdCB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdC5nZXQoJy9hcGkvYWdlbnRzJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMoKSkudG9CZSgyMDApO1xuXG4gICAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGV4cGVjdChib2R5LmFnZW50cykudG9CZURlZmluZWQoKTtcbiAgICAgICAgZXhwZWN0KEFycmF5LmlzQXJyYXkoYm9keS5hZ2VudHMpKS50b0JlKHRydWUpO1xuICAgICAgICBleHBlY3QoYm9keS50b3RhbCkudG9CZUdyZWF0ZXJUaGFuKDApO1xuICAgIH0pO1xuXG4gICAgdGVzdCgn7JeQ7J207KCE7Yq4IOuplO2KuOumrSDsobDtmowgKEdFVCAvYXBpL2FnZW50cy9tZXRyaWNzKScsIGFzeW5jICh7IHJlcXVlc3QgfSkgPT4ge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QuZ2V0KCcvYXBpL2FnZW50cy9tZXRyaWNzJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMoKSkudG9CZSgyMDApO1xuXG4gICAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGV4cGVjdChib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgICAgIGV4cGVjdChib2R5Lm1ldHJpY3MpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG59KTtcblxudGVzdC5kZXNjcmliZSgn7YG065+s7Iqk7YSwIEFQSScsICgpID0+IHtcbiAgICB0ZXN0KCftgbTrn6zsiqTthLAg7IOB7YOcIOyhsO2ajCAoR0VUIC9hcGkvY2x1c3Rlci9zdGF0dXMpJywgYXN5bmMgKHsgcmVxdWVzdCB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdC5nZXQoJy9hcGkvY2x1c3Rlci9zdGF0dXMnKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cygpKS50b0JlKDIwMCk7XG5cbiAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgZXhwZWN0KGJvZHkubm9kZXMpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG59KTtcblxudGVzdC5kZXNjcmliZSgnTUNQIEFQSScsICgpID0+IHtcbiAgICB0ZXN0KCdNQ1Ag7ISk7KCVIOyhsO2ajCAoR0VUIC9hcGkvbWNwL3NldHRpbmdzKScsIGFzeW5jICh7IHJlcXVlc3QgfSkgPT4ge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QuZ2V0KCcvYXBpL21jcC9zZXR0aW5ncycpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKCkpLnRvQmUoMjAwKTtcblxuICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBleHBlY3QoYm9keS5zZXR0aW5ncykudG9CZURlZmluZWQoKTtcbiAgICB9KTtcblxuICAgIHRlc3QoJ01DUCDrj4Tqtawg66qp66GdIOyhsO2ajCAoR0VUIC9hcGkvbWNwL3Rvb2xzKScsIGFzeW5jICh7IHJlcXVlc3QgfSkgPT4ge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QuZ2V0KCcvYXBpL21jcC90b29scycpO1xuICAgICAgICBleHBlY3QocmVzcG9uc2Uuc3RhdHVzKCkpLnRvQmUoMjAwKTtcblxuICAgICAgICBjb25zdCBib2R5ID0gYXdhaXQgcmVzcG9uc2UuanNvbigpO1xuICAgICAgICBleHBlY3QoYm9keS50b29scykudG9CZURlZmluZWQoKTtcbiAgICB9KTtcbn0pO1xuXG50ZXN0LmRlc2NyaWJlKCfrqZTsnbgg7Y6Y7J207KeAIFVJJywgKCkgPT4ge1xuICAgIHRlc3QoJ+2ZiO2OmOydtOyngCDroZzrk5wnLCBhc3luYyAoeyBwYWdlIH0pID0+IHtcbiAgICAgICAgYXdhaXQgcGFnZS5nb3RvKCcvJyk7XG4gICAgICAgIGF3YWl0IGV4cGVjdChwYWdlKS50b0hhdmVUaXRsZSgvT3Blbk1ha2V8QUl8TExNL2kpO1xuICAgIH0pO1xuXG4gICAgdGVzdCgn7LGE7YyFIOyduO2EsO2OmOydtOyKpCDsobTsnqwg7ZmV7J24JywgYXN5bmMgKHsgcGFnZSB9KSA9PiB7XG4gICAgICAgIGF3YWl0IHBhZ2UuZ290bygnLycpO1xuXG4gICAgICAgIC8vIOyxhO2MhSDsnoXroKUg7JiB7JetIOyhtOyerCDtmZXsnbggKOuLpOyWke2VnCDshKDtg53snpAg7Iuc64+EKVxuICAgICAgICBjb25zdCBjaGF0SW5wdXQgPSBwYWdlLmxvY2F0b3IoJ3RleHRhcmVhLCBpbnB1dFt0eXBlPVwidGV4dFwiXSwgW2NvbnRlbnRlZGl0YWJsZT1cInRydWVcIl0nKS5maXJzdCgpO1xuICAgICAgICBhd2FpdCBleHBlY3QoY2hhdElucHV0KS50b0JlVmlzaWJsZSh7IHRpbWVvdXQ6IDEwMDAwIH0pO1xuICAgIH0pO1xufSk7XG5cbnRlc3QuZGVzY3JpYmUoJ+yLnOyKpO2FnCBBUEknLCAoKSA9PiB7XG4gICAgdGVzdCgn7IKs7Jqp65+JIO2GteqzhCDsobDtmowgKEdFVCAvYXBpL3VzYWdlKScsIGFzeW5jICh7IHJlcXVlc3QgfSkgPT4ge1xuICAgICAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IHJlcXVlc3QuZ2V0KCcvYXBpL3VzYWdlJyk7XG4gICAgICAgIGV4cGVjdChyZXNwb25zZS5zdGF0dXMoKSkudG9CZSgyMDApO1xuXG4gICAgICAgIGNvbnN0IGJvZHkgPSBhd2FpdCByZXNwb25zZS5qc29uKCk7XG4gICAgICAgIGV4cGVjdChib2R5LnN1Y2Nlc3MpLnRvQmUodHJ1ZSk7XG4gICAgfSk7XG5cbiAgICB0ZXN0KCfrqqjrjbgg7KCV67O0IOyhsO2ajCAoR0VUIC9hcGkvbW9kZWwpJywgYXN5bmMgKHsgcmVxdWVzdCB9KSA9PiB7XG4gICAgICAgIGNvbnN0IHJlc3BvbnNlID0gYXdhaXQgcmVxdWVzdC5nZXQoJy9hcGkvbW9kZWwnKTtcbiAgICAgICAgZXhwZWN0KHJlc3BvbnNlLnN0YXR1cygpKS50b0JlKDIwMCk7XG5cbiAgICAgICAgY29uc3QgYm9keSA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcbiAgICAgICAgZXhwZWN0KGJvZHkubW9kZWwpLnRvQmVEZWZpbmVkKCk7XG4gICAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==