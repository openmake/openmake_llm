{"file":"/Volumes/MAC_APP/openmake_llm/backend/api/src/__tests__/user-sandbox.test.ts","mappings":"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","names":[],"sources":["/Volumes/MAC_APP/openmake_llm/backend/api/src/__tests__/user-sandbox.test.ts"],"sourcesContent":["import * as path from 'path';\n\n// Import UserSandbox and createUserContext\nimport { UserSandbox, createUserContext } from '../mcp/user-sandbox';\n\ndescribe('UserSandbox', () => {\n    // Get the actual USER_DATA_ROOT by calling getWorkDir and extracting the base path\n    const getActualUserDataRoot = (): string => {\n        const workDir = UserSandbox.getWorkDir('test-user-id');\n        // workDir is like: /path/to/data/users/test-user-id/workspace\n        // We need to extract: /path/to/data/users\n        return path.resolve(workDir, '..', '..');\n    };\n\n    const TEST_USER_DATA_PATH = getActualUserDataRoot();\n\n    describe('getWorkDir(userId)', () => {\n        it('should return correct workspace path for string userId', () => {\n            const result = UserSandbox.getWorkDir('1');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '1', 'workspace'));\n        });\n\n        it('should return correct workspace path for number userId', () => {\n            const result = UserSandbox.getWorkDir(1);\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '1', 'workspace'));\n        });\n\n        it('should handle large userId numbers', () => {\n            const result = UserSandbox.getWorkDir(999999);\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '999999', 'workspace'));\n        });\n\n        it('should handle string userId with special characters', () => {\n            const result = UserSandbox.getWorkDir('user-123');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, 'user-123', 'workspace'));\n        });\n    });\n\n    describe('getDataDir(userId)', () => {\n        it('should return correct data directory path for string userId', () => {\n            const result = UserSandbox.getDataDir('1');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '1', 'data'));\n        });\n\n        it('should return correct data directory path for number userId', () => {\n            const result = UserSandbox.getDataDir(1);\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '1', 'data'));\n        });\n\n        it('should handle large userId numbers', () => {\n            const result = UserSandbox.getDataDir(999999);\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '999999', 'data'));\n        });\n\n        it('should handle string userId with special characters', () => {\n            const result = UserSandbox.getDataDir('user-123');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, 'user-123', 'data'));\n        });\n    });\n\n    describe('getTempDir(userId)', () => {\n        it('should return correct temp directory path for string userId', () => {\n            const result = UserSandbox.getTempDir('1');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '1', 'temp'));\n        });\n\n        it('should return correct temp directory path for number userId', () => {\n            const result = UserSandbox.getTempDir(1);\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '1', 'temp'));\n        });\n\n        it('should handle large userId numbers', () => {\n            const result = UserSandbox.getTempDir(999999);\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '999999', 'temp'));\n        });\n\n        it('should handle string userId with special characters', () => {\n            const result = UserSandbox.getTempDir('user-123');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, 'user-123', 'temp'));\n        });\n    });\n\n    describe('validatePath(userId, targetPath)', () => {\n        it('should allow access to exact user root directory', () => {\n            const userRoot = path.resolve(TEST_USER_DATA_PATH, '1');\n            const result = UserSandbox.validatePath('1', userRoot);\n            expect(result).toBe(true);\n        });\n\n        it('should allow access to files within user workspace', () => {\n            const filePath = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', 'file.txt');\n            const result = UserSandbox.validatePath('1', filePath);\n            expect(result).toBe(true);\n        });\n\n        it('should allow access to nested files within user workspace', () => {\n            const filePath = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', 'subdir', 'file.txt');\n            const result = UserSandbox.validatePath('1', filePath);\n            expect(result).toBe(true);\n        });\n\n        it('should allow access to user data directory', () => {\n            const dataPath = path.resolve(TEST_USER_DATA_PATH, '1', 'data');\n            const result = UserSandbox.validatePath('1', dataPath);\n            expect(result).toBe(true);\n        });\n\n        it('should allow access to user temp directory', () => {\n            const tempPath = path.resolve(TEST_USER_DATA_PATH, '1', 'temp');\n            const result = UserSandbox.validatePath('1', tempPath);\n            expect(result).toBe(true);\n        });\n\n        it('should BLOCK prefix attack: user 1 cannot access user 10 workspace', () => {\n            // This is the critical security test for trailing separator defense\n            const user10Path = path.resolve(TEST_USER_DATA_PATH, '10', 'workspace');\n            const result = UserSandbox.validatePath('1', user10Path);\n            expect(result).toBe(false);\n        });\n\n        it('should BLOCK prefix attack: user 1 cannot access user 10 root', () => {\n            const user10Root = path.resolve(TEST_USER_DATA_PATH, '10');\n            const result = UserSandbox.validatePath('1', user10Root);\n            expect(result).toBe(false);\n        });\n\n        it('should BLOCK access to /etc/passwd', () => {\n            const result = UserSandbox.validatePath('1', '/etc/passwd');\n            expect(result).toBe(false);\n        });\n\n        it('should BLOCK access to /tmp directory', () => {\n            const result = UserSandbox.validatePath('1', '/tmp');\n            expect(result).toBe(false);\n        });\n\n        it('should BLOCK path traversal attack via ../', () => {\n            const traversalPath = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', '..', '..', 'etc', 'passwd');\n            const result = UserSandbox.validatePath('1', traversalPath);\n            expect(result).toBe(false);\n        });\n\n        it('should BLOCK path traversal attack: ../../etc/passwd', () => {\n            const traversalPath = path.resolve(TEST_USER_DATA_PATH, '1', '..', '..', 'etc', 'passwd');\n            const result = UserSandbox.validatePath('1', traversalPath);\n            expect(result).toBe(false);\n        });\n\n        it('should BLOCK access to parent directory', () => {\n            const parentPath = path.resolve(TEST_USER_DATA_PATH, '1', '..');\n            const result = UserSandbox.validatePath('1', parentPath);\n            expect(result).toBe(false);\n        });\n\n        it('should BLOCK access to sibling user directory', () => {\n            const siblingPath = path.resolve(TEST_USER_DATA_PATH, '2', 'workspace');\n            const result = UserSandbox.validatePath('1', siblingPath);\n            expect(result).toBe(false);\n        });\n\n        it('should handle number userId correctly', () => {\n            const filePath = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', 'file.txt');\n            const result = UserSandbox.validatePath(1, filePath);\n            expect(result).toBe(true);\n        });\n\n        it('should handle string userId with special characters', () => {\n            const userRoot = path.resolve(TEST_USER_DATA_PATH, 'user-123');\n            const filePath = path.resolve(userRoot, 'workspace', 'file.txt');\n            const result = UserSandbox.validatePath('user-123', filePath);\n            expect(result).toBe(true);\n        });\n\n        it('should BLOCK access when userId is substring of target path', () => {\n            // User \"1\" should not access \"/tmp/test-sandbox-data/11/workspace\"\n            const user11Path = path.resolve(TEST_USER_DATA_PATH, '11', 'workspace');\n            const result = UserSandbox.validatePath('1', user11Path);\n            expect(result).toBe(false);\n        });\n\n        it('should BLOCK access when userId is substring of target path (user 2 vs 20)', () => {\n            const user20Path = path.resolve(TEST_USER_DATA_PATH, '20', 'workspace');\n            const result = UserSandbox.validatePath('2', user20Path);\n            expect(result).toBe(false);\n        });\n    });\n\n    describe('resolvePath(userId, inputPath)', () => {\n        it('should resolve relative path against workspace directory', () => {\n            const result = UserSandbox.resolvePath('1', 'file.txt');\n            const expected = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', 'file.txt');\n            expect(result).toBe(expected);\n        });\n\n        it('should resolve nested relative path against workspace directory', () => {\n            const result = UserSandbox.resolvePath('1', 'subdir/file.txt');\n            const expected = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', 'subdir', 'file.txt');\n            expect(result).toBe(expected);\n        });\n\n        it('should resolve absolute valid path within user directory', () => {\n            const validPath = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', 'file.txt');\n            const result = UserSandbox.resolvePath('1', validPath);\n            expect(result).toBe(validPath);\n        });\n\n        it('should return null for absolute invalid path outside user directory', () => {\n            const result = UserSandbox.resolvePath('1', '/etc/passwd');\n            expect(result).toBeNull();\n        });\n\n        it('should return null for path traversal attack via relative path', () => {\n            const result = UserSandbox.resolvePath('1', '../../etc/passwd');\n            expect(result).toBeNull();\n        });\n\n        it('should return null for path traversal attack with ../', () => {\n            const result = UserSandbox.resolvePath('1', '../../../etc/passwd');\n            expect(result).toBeNull();\n        });\n\n        it('should return null when trying to access sibling user directory', () => {\n            // Relative path that tries to escape: ../../2/workspace/file.txt\n            // This should resolve outside the user's workspace and be rejected\n            const result = UserSandbox.resolvePath('1', '../../2/workspace/file.txt');\n            expect(result).toBeNull();\n        });\n\n        it('should handle number userId correctly', () => {\n            const result = UserSandbox.resolvePath(1, 'file.txt');\n            const expected = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', 'file.txt');\n            expect(result).toBe(expected);\n        });\n\n        it('should handle string userId with special characters', () => {\n            const result = UserSandbox.resolvePath('user-123', 'file.txt');\n            const expected = path.resolve(TEST_USER_DATA_PATH, 'user-123', 'workspace', 'file.txt');\n            expect(result).toBe(expected);\n        });\n\n        it('should resolve absolute path to user data directory', () => {\n            const dataPath = path.resolve(TEST_USER_DATA_PATH, '1', 'data', 'file.txt');\n            const result = UserSandbox.resolvePath('1', dataPath);\n            expect(result).toBe(dataPath);\n        });\n\n        it('should resolve absolute path to user temp directory', () => {\n            const tempPath = path.resolve(TEST_USER_DATA_PATH, '1', 'temp', 'file.txt');\n            const result = UserSandbox.resolvePath('1', tempPath);\n            expect(result).toBe(tempPath);\n        });\n\n        it('should return null for absolute path to different user workspace', () => {\n            const otherUserPath = path.resolve(TEST_USER_DATA_PATH, '2', 'workspace', 'file.txt');\n            const result = UserSandbox.resolvePath('1', otherUserPath);\n            expect(result).toBeNull();\n        });\n\n        it('should handle empty relative path', () => {\n            const result = UserSandbox.resolvePath('1', '');\n            const expected = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace');\n            expect(result).toBe(expected);\n        });\n\n        it('should handle dot relative path', () => {\n            const result = UserSandbox.resolvePath('1', '.');\n            const expected = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace');\n            expect(result).toBe(expected);\n        });\n\n        it('should handle relative path with multiple segments', () => {\n            const result = UserSandbox.resolvePath('1', 'a/b/c/file.txt');\n            const expected = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', 'a', 'b', 'c', 'file.txt');\n            expect(result).toBe(expected);\n        });\n    });\n\n    describe('createUserContext(userId, tier, role, orgId?)', () => {\n        it('should create user context with all parameters', () => {\n            const context = createUserContext('1', 'pro', 'admin', 'org-123');\n            expect(context.userId).toBe('1');\n            expect(context.tier).toBe('pro');\n            expect(context.role).toBe('admin');\n            expect(context.orgId).toBe('org-123');\n        });\n\n        it('should create user context without orgId', () => {\n            const context = createUserContext('1', 'free', 'user');\n            expect(context.userId).toBe('1');\n            expect(context.tier).toBe('free');\n            expect(context.role).toBe('user');\n            expect(context.orgId).toBeUndefined();\n        });\n\n        it('should create user context with number userId', () => {\n            const context = createUserContext(1, 'enterprise', 'admin', 'org-456');\n            expect(context.userId).toBe(1);\n            expect(context.tier).toBe('enterprise');\n            expect(context.role).toBe('admin');\n            expect(context.orgId).toBe('org-456');\n        });\n\n        it('should create user context with guest role', () => {\n            const context = createUserContext('2', 'free', 'guest');\n            expect(context.userId).toBe('2');\n            expect(context.tier).toBe('free');\n            expect(context.role).toBe('guest');\n            expect(context.orgId).toBeUndefined();\n        });\n\n        it('should create user context with pro tier', () => {\n            const context = createUserContext('3', 'pro', 'user', 'org-789');\n            expect(context.userId).toBe('3');\n            expect(context.tier).toBe('pro');\n            expect(context.role).toBe('user');\n            expect(context.orgId).toBe('org-789');\n        });\n\n        it('should create user context with enterprise tier', () => {\n            const context = createUserContext('4', 'enterprise', 'admin');\n            expect(context.userId).toBe('4');\n            expect(context.tier).toBe('enterprise');\n            expect(context.role).toBe('admin');\n            expect(context.orgId).toBeUndefined();\n        });\n\n        it('should preserve all properties in returned context', () => {\n            const context = createUserContext('test-user', 'pro', 'user', 'test-org');\n            expect(Object.keys(context)).toContain('userId');\n            expect(Object.keys(context)).toContain('tier');\n            expect(Object.keys(context)).toContain('role');\n            expect(Object.keys(context)).toContain('orgId');\n        });\n\n        it('should handle string userId with special characters', () => {\n            const context = createUserContext('user-123-abc', 'free', 'guest');\n            expect(context.userId).toBe('user-123-abc');\n            expect(context.tier).toBe('free');\n            expect(context.role).toBe('guest');\n        });\n    });\n\n    describe('Security: Comprehensive Path Traversal Tests', () => {\n        it('should prevent directory traversal with normalized paths', () => {\n            const traversalPath = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace', '..', '..', '..', 'etc', 'passwd');\n            const result = UserSandbox.validatePath('1', traversalPath);\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to parent of user root', () => {\n            const parentPath = path.resolve(TEST_USER_DATA_PATH, '1', '..');\n            const result = UserSandbox.validatePath('1', parentPath);\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to test-sandbox-data root', () => {\n            const result = UserSandbox.validatePath('1', TEST_USER_DATA_PATH);\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to filesystem root', () => {\n            const result = UserSandbox.validatePath('1', '/');\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to /home directory', () => {\n            const result = UserSandbox.validatePath('1', '/home');\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to /var directory', () => {\n            const result = UserSandbox.validatePath('1', '/var');\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to /usr directory', () => {\n            const result = UserSandbox.validatePath('1', '/usr');\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to /bin directory', () => {\n            const result = UserSandbox.validatePath('1', '/bin');\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to /opt directory', () => {\n            const result = UserSandbox.validatePath('1', '/opt');\n            expect(result).toBe(false);\n        });\n\n        it('should prevent access to /root directory', () => {\n            const result = UserSandbox.validatePath('1', '/root');\n            expect(result).toBe(false);\n        });\n    });\n\n    describe('Edge Cases', () => {\n        it('should handle userId \"0\" correctly', () => {\n            const result = UserSandbox.getWorkDir('0');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '0', 'workspace'));\n        });\n\n        it('should handle userId with leading zeros', () => {\n            const result = UserSandbox.getWorkDir('001');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, '001', 'workspace'));\n        });\n\n        it('should handle very long userId', () => {\n            const longUserId = 'a'.repeat(100);\n            const result = UserSandbox.getWorkDir(longUserId);\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, longUserId, 'workspace'));\n        });\n\n        it('should handle userId with hyphens and underscores', () => {\n            const result = UserSandbox.getWorkDir('user_123-abc');\n            expect(result).toBe(path.resolve(TEST_USER_DATA_PATH, 'user_123-abc', 'workspace'));\n        });\n\n        it('should handle resolvePath with dot-dot at the end', () => {\n            const result = UserSandbox.resolvePath('1', 'file.txt/..');\n            const expected = path.resolve(TEST_USER_DATA_PATH, '1', 'workspace');\n            expect(result).toBe(expected);\n        });\n\n        it('should handle validatePath with trailing slash', () => {\n            const userRoot = path.resolve(TEST_USER_DATA_PATH, '1') + path.sep;\n            const result = UserSandbox.validatePath('1', userRoot);\n            expect(result).toBe(true);\n        });\n\n        it('should handle validatePath with multiple trailing slashes', () => {\n            const userRoot = path.resolve(TEST_USER_DATA_PATH, '1') + path.sep + path.sep;\n            const result = UserSandbox.validatePath('1', userRoot);\n            expect(result).toBe(true);\n        });\n    });\n});\n"],"version":3}