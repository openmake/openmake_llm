fa2259c4a5174dbdb350eb1b8575fcb5
"use strict";
/**
 * MCPServerRegistry Unit Tests
 * DB 및 ExternalMCPClient 연결은 모킹 — 레지스트리 관리 로직 검증
 */
var __awaiter = (this && this.__awaiter) || function (thisArg, _arguments, P, generator) {
    function adopt(value) { return value instanceof P ? value : new P(function (resolve) { resolve(value); }); }
    return new (P || (P = Promise))(function (resolve, reject) {
        function fulfilled(value) { try { step(generator.next(value)); } catch (e) { reject(e); } }
        function rejected(value) { try { step(generator["throw"](value)); } catch (e) { reject(e); } }
        function step(result) { result.done ? resolve(result.value) : adopt(result.value).then(fulfilled, rejected); }
        step((generator = generator.apply(thisArg, _arguments || [])).next());
    });
};
Object.defineProperty(exports, "__esModule", { value: true });
const server_registry_1 = require("../server-registry");
const tool_router_1 = require("../tool-router");
describe('MCPServerRegistry', () => {
    let toolRouter;
    let registry;
    beforeEach(() => {
        toolRouter = new tool_router_1.ToolRouter();
        registry = new server_registry_1.MCPServerRegistry(toolRouter);
    });
    describe('constructor', () => {
        it('should create with zero connections', () => {
            expect(registry.getConnectionCount()).toBe(0);
        });
        it('should return empty statuses', () => {
            expect(registry.getAllStatuses()).toEqual([]);
        });
    });
    describe('getServerStatus', () => {
        it('should return undefined for unknown server', () => {
            expect(registry.getServerStatus('unknown')).toBeUndefined();
        });
    });
    describe('pingServer', () => {
        it('should return false for unknown server', () => __awaiter(void 0, void 0, void 0, function* () {
            const result = yield registry.pingServer('unknown');
            expect(result).toBe(false);
        }));
    });
    describe('getClient', () => {
        it('should return undefined for unknown server', () => {
            expect(registry.getClient('unknown')).toBeUndefined();
        });
    });
    describe('disconnectAll', () => {
        it('should safely disconnect with no connections', () => __awaiter(void 0, void 0, void 0, function* () {
            // Should not throw
            yield registry.disconnectAll();
            expect(registry.getConnectionCount()).toBe(0);
        }));
    });
    describe('disconnectServer', () => {
        it('should safely disconnect unknown server', () => __awaiter(void 0, void 0, void 0, function* () {
            // Should not throw
            yield registry.disconnectServer('unknown');
            expect(registry.getConnectionCount()).toBe(0);
        }));
    });
    describe('connectServer (failure cases)', () => {
        it('should handle connect failure for missing command', () => __awaiter(void 0, void 0, void 0, function* () {
            try {
                yield registry.connectServer('test-1', {
                    id: 'test-1',
                    name: 'broken',
                    transport_type: 'stdio',
                    // Missing command
                    enabled: true,
                    created_at: new Date().toISOString(),
                    updated_at: new Date().toISOString(),
                });
                // Should throw
                expect(true).toBe(false);
            }
            catch (e) {
                // Expected: connection should fail
                // Client is created but connection fails, then status is error
                const status = registry.getServerStatus('test-1');
                expect(status).toBeDefined();
                expect(status.status).toBe('error');
            }
        }));
    });
    describe('integration with ToolRouter', () => {
        it('should reflect tool count in router after disconnect', () => __awaiter(void 0, void 0, void 0, function* () {
            // Pre-register tools in router to test unregister path
            toolRouter.registerExternalTools('srv-x', 'extserver', [
                { name: 'tool1', description: 'T1', inputSchema: { type: 'object', properties: {}, required: [] } }
            ], () => __awaiter(void 0, void 0, void 0, function* () { return ({ content: [{ type: 'text', text: 'ok' }] }); }));
            expect(toolRouter.getExternalToolCount()).toBe(1);
            // Unregister via router directly (registry.disconnectServer calls this)
            toolRouter.unregisterExternalTools('srv-x');
            expect(toolRouter.getExternalToolCount()).toBe(0);
        }));
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1ZvbHVtZXMvTUFDX0FQUC9vcGVubWFrZV9sbG0vYmFja2VuZC9hcGkvc3JjL21jcC9fX3Rlc3RzX18vc2VydmVyLXJlZ2lzdHJ5LnRlc3QudHMiLCJtYXBwaW5ncyI6IjtBQUFBOzs7R0FHRzs7Ozs7Ozs7Ozs7QUFFSCx3REFBdUQ7QUFDdkQsZ0RBQTRDO0FBRTVDLFFBQVEsQ0FBQyxtQkFBbUIsRUFBRSxHQUFHLEVBQUU7SUFDL0IsSUFBSSxVQUFzQixDQUFDO0lBQzNCLElBQUksUUFBMkIsQ0FBQztJQUVoQyxVQUFVLENBQUMsR0FBRyxFQUFFO1FBQ1osVUFBVSxHQUFHLElBQUksd0JBQVUsRUFBRSxDQUFDO1FBQzlCLFFBQVEsR0FBRyxJQUFJLG1DQUFpQixDQUFDLFVBQVUsQ0FBQyxDQUFDO0lBQ2pELENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGFBQWEsRUFBRSxHQUFHLEVBQUU7UUFDekIsRUFBRSxDQUFDLHFDQUFxQyxFQUFFLEdBQUcsRUFBRTtZQUMzQyxNQUFNLENBQUMsUUFBUSxDQUFDLGtCQUFrQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7UUFFSCxFQUFFLENBQUMsOEJBQThCLEVBQUUsR0FBRyxFQUFFO1lBQ3BDLE1BQU0sQ0FBQyxRQUFRLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDbEQsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxpQkFBaUIsRUFBRSxHQUFHLEVBQUU7UUFDN0IsRUFBRSxDQUFDLDRDQUE0QyxFQUFFLEdBQUcsRUFBRTtZQUNsRCxNQUFNLENBQUMsUUFBUSxDQUFDLGVBQWUsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ2hFLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsWUFBWSxFQUFFLEdBQUcs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QUFRLEVBQUUsVUFBVSxFQUFFLEVBQUUsRUFBRSxRQUFRLEVBQUUsRUFBRSxFQUFFLEVBQUU7YUFDdEcsRUFBRSxHQUFTLEVBQUUsa0RBQUMsT0FBQSxDQUFDLEVBQUUsT0FBTyxFQUFFLENBQUMsRUFBRSxJQUFJLEVBQUUsTUFBTSxFQUFFLElBQUksRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQSxHQUFBLENBQUMsQ0FBQztZQUU5RCxNQUFNLENBQUMsVUFBVSxDQUFDLG9CQUFvQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7WUFFbEQsd0VBQXdFO1lBQ3hFLFVBQVUsQ0FBQyx1QkFBdUIsQ0FBQyxPQUFPLENBQUMsQ0FBQztZQUM1QyxNQUFNLENBQUMsVUFBVSxDQUFDLG9CQUFvQixFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFDdEQsQ0FBQyxDQUFBLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0FBQ1AsQ0FBQyxDQUFDLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1ZvbHVtZXMvTUFDX0FQUC9vcGVubWFrZV9sbG0vYmFja2VuZC9hcGkvc3JjL21jcC9fX3Rlc3RzX18vc2VydmVyLXJlZ2lzdHJ5LnRlc3QudHMiXSwic291cmNlc0NvbnRlbnQiOlsiLyoqXG4gKiBNQ1BTZXJ2ZXJSZWdpc3RyeSBVbml0IFRlc3RzXG4gKiBEQiDrsI8gRXh0ZXJuYWxNQ1BDbGllbnQg7Jew6rKw7J2AIOuqqO2CuSDigJQg66CI7KeA7Iqk7Yq466asIOq0gOumrCDroZzsp4Eg6rKA7KadXG4gKi9cblxuaW1wb3J0IHsgTUNQU2VydmVyUmVnaXN0cnkgfSBmcm9tICcuLi9zZXJ2ZXItcmVnaXN0cnknO1xuaW1wb3J0IHsgVG9vbFJvdXRlciB9IGZyb20gJy4uL3Rvb2wtcm91dGVyJztcblxuZGVzY3JpYmUoJ01DUFNlcnZlclJlZ2lzdHJ5JywgKCkgPT4ge1xuICAgIGxldCB0b29sUm91dGVyOiBUb29sUm91dGVyO1xuICAgIGxldCByZWdpc3RyeTogTUNQU2VydmVyUmVnaXN0cnk7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgdG9vbFJvdXRlciA9IG5ldyBUb29sUm91dGVyKCk7XG4gICAgICAgIHJlZ2lzdHJ5ID0gbmV3IE1DUFNlcnZlclJlZ2lzdHJ5KHRvb2xSb3V0ZXIpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSB3aXRoIHplcm8gY29ubmVjdGlvbnMnLCAoKSA9PiB7XG4gICAgICAgICAgICBleHBlY3QocmVnaXN0cnkuZ2V0Q29ubmVjdGlvbkNvdW50KCkpLnRvQmUoMCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGVtcHR5IHN0YXR1c2VzJywgKCkgPT4ge1xuICAgICAgICAgICAgZXhwZWN0KHJlZ2lzdHJ5LmdldEFsbFN0YXR1c2VzKCkpLnRvRXF1YWwoW10pO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdnZXRTZXJ2ZXJTdGF0dXMnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIHVuZGVmaW5lZCBmb3IgdW5rbm93biBzZXJ2ZXInLCAoKSA9PiB7XG4gICAgICAgICAgICBleHBlY3QocmVnaXN0cnkuZ2V0U2VydmVyU3RhdHVzKCd1bmtub3duJykpLnRvQmVVbmRlZmluZWQoKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgncGluZ1NlcnZlcicsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZmFsc2UgZm9yIHVua25vd24gc2VydmVyJywgYXN5bmMgKCkgPT4ge1xuICAgICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcmVnaXN0cnkucGluZ1NlcnZlcigndW5rbm93bicpO1xuICAgICAgICAgICAgZXhwZWN0KHJlc3VsdCkudG9CZShmYWxzZSk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2dldENsaWVudCcsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gdW5kZWZpbmVkIGZvciB1bmtub3duIHNlcnZlcicsICgpID0+IHtcbiAgICAgICAgICAgIGV4cGVjdChyZWdpc3RyeS5nZXRDbGllbnQoJ3Vua25vd24nKSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdkaXNjb25uZWN0QWxsJywgKCkgPT4ge1xuICAgICAgICBpdCgnc2hvdWxkIHNhZmVseSBkaXNjb25uZWN0IHdpdGggbm8gY29ubmVjdGlvbnMnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBTaG91bGQgbm90IHRocm93XG4gICAgICAgICAgICBhd2FpdCByZWdpc3RyeS5kaXNjb25uZWN0QWxsKCk7XG4gICAgICAgICAgICBleHBlY3QocmVnaXN0cnkuZ2V0Q29ubmVjdGlvbkNvdW50KCkpLnRvQmUoMCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2Rpc2Nvbm5lY3RTZXJ2ZXInLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgc2FmZWx5IGRpc2Nvbm5lY3QgdW5rbm93biBzZXJ2ZXInLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBTaG91bGQgbm90IHRocm93XG4gICAgICAgICAgICBhd2FpdCByZWdpc3RyeS5kaXNjb25uZWN0U2VydmVyKCd1bmtub3duJyk7XG4gICAgICAgICAgICBleHBlY3QocmVnaXN0cnkuZ2V0Q29ubmVjdGlvbkNvdW50KCkpLnRvQmUoMCk7XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2Nvbm5lY3RTZXJ2ZXIgKGZhaWx1cmUgY2FzZXMpJywgKCkgPT4ge1xuICAgICAgICBpdCgnc2hvdWxkIGhhbmRsZSBjb25uZWN0IGZhaWx1cmUgZm9yIG1pc3NpbmcgY29tbWFuZCcsIGFzeW5jICgpID0+IHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgICAgYXdhaXQgcmVnaXN0cnkuY29ubmVjdFNlcnZlcigndGVzdC0xJywge1xuICAgICAgICAgICAgICAgICAgICBpZDogJ3Rlc3QtMScsXG4gICAgICAgICAgICAgICAgICAgIG5hbWU6ICdicm9rZW4nLFxuICAgICAgICAgICAgICAgICAgICB0cmFuc3BvcnRfdHlwZTogJ3N0ZGlvJyxcbiAgICAgICAgICAgICAgICAgICAgLy8gTWlzc2luZyBjb21tYW5kXG4gICAgICAgICAgICAgICAgICAgIGVuYWJsZWQ6IHRydWUsXG4gICAgICAgICAgICAgICAgICAgIGNyZWF0ZWRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSxcbiAgICAgICAgICAgICAgICAgICAgdXBkYXRlZF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLFxuICAgICAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgICAgIC8vIFNob3VsZCB0aHJvd1xuICAgICAgICAgICAgICAgIGV4cGVjdCh0cnVlKS50b0JlKGZhbHNlKTtcbiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAvLyBFeHBlY3RlZDogY29ubmVjdGlvbiBzaG91bGQgZmFpbFxuICAgICAgICAgICAgICAgIC8vIENsaWVudCBpcyBjcmVhdGVkIGJ1dCBjb25uZWN0aW9uIGZhaWxzLCB0aGVuIHN0YXR1cyBpcyBlcnJvclxuICAgICAgICAgICAgICAgIGNvbnN0IHN0YXR1cyA9IHJlZ2lzdHJ5LmdldFNlcnZlclN0YXR1cygndGVzdC0xJyk7XG4gICAgICAgICAgICAgICAgZXhwZWN0KHN0YXR1cykudG9CZURlZmluZWQoKTtcbiAgICAgICAgICAgICAgICBleHBlY3Qoc3RhdHVzIS5zdGF0dXMpLnRvQmUoJ2Vycm9yJyk7XG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2ludGVncmF0aW9uIHdpdGggVG9vbFJvdXRlcicsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCByZWZsZWN0IHRvb2wgY291bnQgaW4gcm91dGVyIGFmdGVyIGRpc2Nvbm5lY3QnLCBhc3luYyAoKSA9PiB7XG4gICAgICAgICAgICAvLyBQcmUtcmVnaXN0ZXIgdG9vbHMgaW4gcm91dGVyIHRvIHRlc3QgdW5yZWdpc3RlciBwYXRoXG4gICAgICAgICAgICB0b29sUm91dGVyLnJlZ2lzdGVyRXh0ZXJuYWxUb29scygnc3J2LXgnLCAnZXh0c2VydmVyJywgW1xuICAgICAgICAgICAgICAgIHsgbmFtZTogJ3Rvb2wxJywgZGVzY3JpcHRpb246ICdUMScsIGlucHV0U2NoZW1hOiB7IHR5cGU6ICdvYmplY3QnLCBwcm9wZXJ0aWVzOiB7fSwgcmVxdWlyZWQ6IFtdIH0gfVxuICAgICAgICAgICAgXSwgYXN5bmMgKCkgPT4gKHsgY29udGVudDogW3sgdHlwZTogJ3RleHQnLCB0ZXh0OiAnb2snIH1dIH0pKTtcblxuICAgICAgICAgICAgZXhwZWN0KHRvb2xSb3V0ZXIuZ2V0RXh0ZXJuYWxUb29sQ291bnQoKSkudG9CZSgxKTtcblxuICAgICAgICAgICAgLy8gVW5yZWdpc3RlciB2aWEgcm91dGVyIGRpcmVjdGx5IChyZWdpc3RyeS5kaXNjb25uZWN0U2VydmVyIGNhbGxzIHRoaXMpXG4gICAgICAgICAgICB0b29sUm91dGVyLnVucmVnaXN0ZXJFeHRlcm5hbFRvb2xzKCdzcnYteCcpO1xuICAgICAgICAgICAgZXhwZWN0KHRvb2xSb3V0ZXIuZ2V0RXh0ZXJuYWxUb29sQ291bnQoKSkudG9CZSgwKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG59KTtcbiJdLCJ2ZXJzaW9uIjozfQ==