ae2bbddb57b66cf454793392b225c774
"use strict";
/**
 * üÜï ÌÜµÌï© Î°úÍπÖ ÏãúÏä§ÌÖú
 * Winston Í∏∞Î∞ò Íµ¨Ï°∞ÌôîÎêú Î°úÍπÖ
 */
var __rest = (this && this.__rest) || function (s, e) {
    var t = {};
    for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0)
        t[p] = s[p];
    if (s != null && typeof Object.getOwnPropertySymbols === "function")
        for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {
            if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i]))
                t[p[i]] = s[p[i]];
        }
    return t;
};
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.logger = void 0;
exports.createLogger = createLogger;
const winston_1 = __importDefault(require("winston"));
const path_1 = __importDefault(require("path"));
const env_1 = require("../config/env");
const logDir = path_1.default.join(__dirname, '../../logs');
// Ïª§Ïä§ÌÖÄ Ìè¨Îß∑
const customFormat = winston_1.default.format.combine(winston_1.default.format.timestamp({ format: 'YYYY-MM-DD HH:mm:ss' }), winston_1.default.format.errors({ stack: true }), winston_1.default.format.printf((_a) => {
    var { level, message, timestamp } = _a, meta = __rest(_a, ["level", "message", "timestamp"]);
    const metaStr = Object.keys(meta).length ? JSON.stringify(meta) : '';
    return `[${timestamp}] ${level.toUpperCase()}: ${message} ${metaStr}`;
}));
// ÏΩòÏÜî Ìè¨Îß∑ (Ïª¨Îü¨)
const consoleFormat = winston_1.default.format.combine(winston_1.default.format.colorize(), winston_1.default.format.timestamp({ format: 'HH:mm:ss' }), winston_1.default.format.printf(({ level, message, timestamp }) => {
    return `[${timestamp}] ${level}: ${message}`;
}));
// Î°úÍ±∞ ÏÉùÏÑ±
exports.logger = winston_1.default.createLogger({
    level: (0, env_1.getConfig)().logLevel,
    format: customFormat,
    transports: [
        // ÏΩòÏÜî Ï∂úÎ†•
        new winston_1.default.transports.Console({
            format: consoleFormat
        }),
        // ÏóêÎü¨ Î°úÍ∑∏ ÌååÏùº
        new winston_1.default.transports.File({
            filename: path_1.default.join(logDir, 'error.log'),
            level: 'error',
            maxsize: 5242880, // 5MB
            maxFiles: 5
        }),
        // Ï†ÑÏ≤¥ Î°úÍ∑∏ ÌååÏùº
        new winston_1.default.transports.File({
            filename: path_1.default.join(logDir, 'combined.log'),
            maxsize: 5242880,
            maxFiles: 5
        })
    ]
});
// Ïπ¥ÌÖåÍ≥†Î¶¨Î≥Ñ Î°úÍ±∞ ÏÉùÏÑ±
function createLogger(category) {
    return {
        debug: (msg, meta) => exports.logger.debug(`[${category}] ${msg}`, meta),
        info: (msg, meta) => exports.logger.info(`[${category}] ${msg}`, meta),
        warn: (msg, meta) => exports.logger.warn(`[${category}] ${msg}`, meta),
        error: (msg, meta) => exports.logger.error(`[${category}] ${msg}`, meta)
    };
}
exports.default = exports.logger;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1ZvbHVtZXMvTUFDX0FQUC9vcGVubWFrZV9sbG0vYmFja2VuZC9hcGkvc3JjL3V0aWxzL2xvZ2dlci50cyIsIm1hcHBpbmdzIjoiO0FBQUE7OztHQUdHOzs7Ozs7Ozs7Ozs7Ozs7OztBQXFESCxvQ0FPQztBQTFERCxzREFBOEI7QUFDOUIsZ0RBQXdCO0FBQ3hCLHVDQUEwQztBQUUxQyxNQUFNLE1BQU0sR0FBRyxjQUFJLENBQUMsSUFBSSxDQUFDLFNBQVMsRUFBRSxZQUFZLENBQUMsQ0FBQztBQUVsRCxTQUFTO0FBQ1QsTUFBTSxZQUFZLEdBQUcsaUJBQU8sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUN2QyxpQkFBTyxDQUFDLE1BQU0sQ0FBQyxTQUFTLENBQUMsRUFBRSxNQUFNLEVBQUUscUJBQXFCLEVBQUUsQ0FBQyxFQUMzRCxpQkFBTyxDQUFDLE1BQU0sQ0FBQyxNQUFNLENBQUMsRUFBRSxLQUFLLEVBQUUsSUFBSSxFQUFFLENBQUMsRUFDdEMsaUJBQU8sQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUMsRUFBc0MsRUFBRSxFQUFFO1FBQTFDLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxTQUFTLE9BQVcsRUFBTixJQUFJLGNBQXBDLGlDQUFzQyxDQUFGO0lBQ3ZELE1BQU0sT0FBTyxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDLENBQUMsTUFBTSxDQUFDLENBQUMsQ0FBQyxJQUFJLENBQUMsU0FBUyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQyxFQUFFLENBQUM7SUFDckUsT0FBTyxJQUFJLFNBQVMsS0FBSyxLQUFLLENBQUMsV0FBVyxFQUFFLEtBQUssT0FBTyxJQUFJLE9BQU8sRUFBRSxDQUFDO0FBQzFFLENBQUMsQ0FBQyxDQUNMLENBQUM7QUFFRixhQUFhO0FBQ2IsTUFBTSxhQUFhLEdBQUcsaUJBQU8sQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUN4QyxpQkFBTyxDQUFDLE1BQU0sQ0FBQyxRQUFRLEVBQUUsRUFDekIsaUJBQU8sQ0FBQyxNQUFNLENBQUMsU0FBUyxDQUFDLEVBQUUsTUFBTSxFQUFFLFVBQVUsRUFBRSxDQUFDLEVBQ2hELGlCQUFPLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFDLEVBQUUsS0FBSyxFQUFFLE9BQU8sRUFBRSxTQUFTLEVBQUUsRUFBRSxFQUFFO0lBQ3BELE9BQU8sSUFBSSxTQUFTLEtBQUssS0FBSyxLQUFLLE9BQU8sRUFBRSxDQUFDO0FBQ2pELENBQUMsQ0FBQyxDQUNMLENBQUM7QUFFRixRQUFRO0FBQ0ssUUFBQSxNQUFNLEdBQUcsaUJBQU8sQ0FBQyxZQUFZLENBQUM7SUFDdkMsS0FBSyxFQUFFLElBQUEsZUFBUyxHQUFFLENBQUMsUUFBUTtJQUMzQixNQUFNLEVBQUUsWUFBWTtJQUNwQixVQUFVLEVBQUU7UUFDUixRQUFRO1FBQ1IsSUFBSSxpQkFBTyxDQUFDLFVBQVUsQ0FBQyxPQUFPLENBQUM7WUFDM0IsTUFBTSxFQUFFLGFBQWE7U0FDeEIsQ0FBQztRQUNGLFdBQVc7UUFDWCxJQUFJLGlCQUFPLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQztZQUN4QixRQUFRLEVBQUUsY0FBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsV0FBVyxDQUFDO1lBQ3hDLEtBQUssRUFBRSxPQUFPO1lBQ2QsT0FBTyxFQUFFLE9BQU8sRUFBRSxNQUFNO1lBQ3hCLFFBQVEsRUFBRSxDQUFDO1NBQ2QsQ0FBQztRQUNGLFdBQVc7UUFDWCxJQUFJLGlCQUFPLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQztZQUN4QixRQUFRLEVBQUUsY0FBSSxDQUFDLElBQUksQ0FBQyxNQUFNLEVBQUUsY0FBYyxDQUFDO1lBQzNDLE9BQU8sRUFBRSxPQUFPO1lBQ2hCLFFBQVEsRUFBRSxDQUFDO1NBQ2QsQ0FBQztLQUNMO0NBQ0osQ0FBQyxDQUFDO0FBRUgsY0FBYztBQUNkLFNBQWdCLFlBQVksQ0FBQyxRQUFnQjtJQUN6QyxPQUFPO1FBQ0gsS0FBSyxFQUFFLENBQUMsR0FBVyxFQUFFLElBQWMsRUFBRSxFQUFFLENBQUMsY0FBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLFFBQVEsS0FBSyxHQUFHLEVBQUUsRUFBRSxJQUFJLENBQUM7UUFDbEYsSUFBSSxFQUFFLENBQUMsR0FBVyxFQUFFLElBQWMsRUFBRSxFQUFFLENBQUMsY0FBTSxDQUFDLElBQUksQ0FBQyxJQUFJLFFBQVEsS0FBSyxHQUFHLEVBQUUsRUFBRSxJQUFJLENBQUM7UUFDaEYsSUFBSSxFQUFFLENBQUMsR0FBVyxFQUFFLElBQWMsRUFBRSxFQUFFLENBQUMsY0FBTSxDQUFDLElBQUksQ0FBQyxJQUFJLFFBQVEsS0FBSyxHQUFHLEVBQUUsRUFBRSxJQUFJLENBQUM7UUFDaEYsS0FBSyxFQUFFLENBQUMsR0FBVyxFQUFFLElBQWMsRUFBRSxFQUFFLENBQUMsY0FBTSxDQUFDLEtBQUssQ0FBQyxJQUFJLFFBQVEsS0FBSyxHQUFHLEVBQUUsRUFBRSxJQUFJLENBQUM7S0FDckYsQ0FBQztBQUNOLENBQUM7QUFFRCxrQkFBZSxjQUFNLENBQUMiLCJuYW1lcyI6W10sInNvdXJjZXMiOlsiL1ZvbHVtZXMvTUFDX0FQUC9vcGVubWFrZV9sbG0vYmFja2VuZC9hcGkvc3JjL3V0aWxzL2xvZ2dlci50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIPCfhpUg7Ya17ZWpIOuhnOq5hSDsi5zsiqTthZxcbiAqIFdpbnN0b24g6riw67CYIOq1rOyhsO2ZlOuQnCDroZzquYVcbiAqL1xuXG5pbXBvcnQgd2luc3RvbiBmcm9tICd3aW5zdG9uJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuaW1wb3J0IHsgZ2V0Q29uZmlnIH0gZnJvbSAnLi4vY29uZmlnL2Vudic7XG5cbmNvbnN0IGxvZ0RpciA9IHBhdGguam9pbihfX2Rpcm5hbWUsICcuLi8uLi9sb2dzJyk7XG5cbi8vIOy7pOyKpO2FgCDtj6zrp7dcbmNvbnN0IGN1c3RvbUZvcm1hdCA9IHdpbnN0b24uZm9ybWF0LmNvbWJpbmUoXG4gICAgd2luc3Rvbi5mb3JtYXQudGltZXN0YW1wKHsgZm9ybWF0OiAnWVlZWS1NTS1ERCBISDptbTpzcycgfSksXG4gICAgd2luc3Rvbi5mb3JtYXQuZXJyb3JzKHsgc3RhY2s6IHRydWUgfSksXG4gICAgd2luc3Rvbi5mb3JtYXQucHJpbnRmKCh7IGxldmVsLCBtZXNzYWdlLCB0aW1lc3RhbXAsIC4uLm1ldGEgfSkgPT4ge1xuICAgICAgICBjb25zdCBtZXRhU3RyID0gT2JqZWN0LmtleXMobWV0YSkubGVuZ3RoID8gSlNPTi5zdHJpbmdpZnkobWV0YSkgOiAnJztcbiAgICAgICAgcmV0dXJuIGBbJHt0aW1lc3RhbXB9XSAke2xldmVsLnRvVXBwZXJDYXNlKCl9OiAke21lc3NhZ2V9ICR7bWV0YVN0cn1gO1xuICAgIH0pXG4pO1xuXG4vLyDsvZjshpQg7Y+s66e3ICjsu6zrn6wpXG5jb25zdCBjb25zb2xlRm9ybWF0ID0gd2luc3Rvbi5mb3JtYXQuY29tYmluZShcbiAgICB3aW5zdG9uLmZvcm1hdC5jb2xvcml6ZSgpLFxuICAgIHdpbnN0b24uZm9ybWF0LnRpbWVzdGFtcCh7IGZvcm1hdDogJ0hIOm1tOnNzJyB9KSxcbiAgICB3aW5zdG9uLmZvcm1hdC5wcmludGYoKHsgbGV2ZWwsIG1lc3NhZ2UsIHRpbWVzdGFtcCB9KSA9PiB7XG4gICAgICAgIHJldHVybiBgWyR7dGltZXN0YW1wfV0gJHtsZXZlbH06ICR7bWVzc2FnZX1gO1xuICAgIH0pXG4pO1xuXG4vLyDroZzqsbAg7IOd7ISxXG5leHBvcnQgY29uc3QgbG9nZ2VyID0gd2luc3Rvbi5jcmVhdGVMb2dnZXIoe1xuICAgIGxldmVsOiBnZXRDb25maWcoKS5sb2dMZXZlbCxcbiAgICBmb3JtYXQ6IGN1c3RvbUZvcm1hdCxcbiAgICB0cmFuc3BvcnRzOiBbXG4gICAgICAgIC8vIOy9mOyGlCDstpzroKVcbiAgICAgICAgbmV3IHdpbnN0b24udHJhbnNwb3J0cy5Db25zb2xlKHtcbiAgICAgICAgICAgIGZvcm1hdDogY29uc29sZUZvcm1hdFxuICAgICAgICB9KSxcbiAgICAgICAgLy8g7JeQ65+sIOuhnOq3uCDtjIzsnbxcbiAgICAgICAgbmV3IHdpbnN0b24udHJhbnNwb3J0cy5GaWxlKHtcbiAgICAgICAgICAgIGZpbGVuYW1lOiBwYXRoLmpvaW4obG9nRGlyLCAnZXJyb3IubG9nJyksXG4gICAgICAgICAgICBsZXZlbDogJ2Vycm9yJyxcbiAgICAgICAgICAgIG1heHNpemU6IDUyNDI4ODAsIC8vIDVNQlxuICAgICAgICAgICAgbWF4RmlsZXM6IDVcbiAgICAgICAgfSksXG4gICAgICAgIC8vIOyghOyytCDroZzqt7gg7YyM7J28XG4gICAgICAgIG5ldyB3aW5zdG9uLnRyYW5zcG9ydHMuRmlsZSh7XG4gICAgICAgICAgICBmaWxlbmFtZTogcGF0aC5qb2luKGxvZ0RpciwgJ2NvbWJpbmVkLmxvZycpLFxuICAgICAgICAgICAgbWF4c2l6ZTogNTI0Mjg4MCxcbiAgICAgICAgICAgIG1heEZpbGVzOiA1XG4gICAgICAgIH0pXG4gICAgXVxufSk7XG5cbi8vIOy5tO2FjOqzoOumrOuzhCDroZzqsbAg7IOd7ISxXG5leHBvcnQgZnVuY3Rpb24gY3JlYXRlTG9nZ2VyKGNhdGVnb3J5OiBzdHJpbmcpIHtcbiAgICByZXR1cm4ge1xuICAgICAgICBkZWJ1ZzogKG1zZzogc3RyaW5nLCBtZXRhPzogdW5rbm93bikgPT4gbG9nZ2VyLmRlYnVnKGBbJHtjYXRlZ29yeX1dICR7bXNnfWAsIG1ldGEpLFxuICAgICAgICBpbmZvOiAobXNnOiBzdHJpbmcsIG1ldGE/OiB1bmtub3duKSA9PiBsb2dnZXIuaW5mbyhgWyR7Y2F0ZWdvcnl9XSAke21zZ31gLCBtZXRhKSxcbiAgICAgICAgd2FybjogKG1zZzogc3RyaW5nLCBtZXRhPzogdW5rbm93bikgPT4gbG9nZ2VyLndhcm4oYFske2NhdGVnb3J5fV0gJHttc2d9YCwgbWV0YSksXG4gICAgICAgIGVycm9yOiAobXNnOiBzdHJpbmcsIG1ldGE/OiB1bmtub3duKSA9PiBsb2dnZXIuZXJyb3IoYFske2NhdGVnb3J5fV0gJHttc2d9YCwgbWV0YSlcbiAgICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBsb2dnZXI7XG4iXSwidmVyc2lvbiI6M30=