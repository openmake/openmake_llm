{"file":"/Volumes/MAC_APP/openmake_llm/backend/api/src/auth/index.ts","mappings":"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","names":[],"sources":["/Volumes/MAC_APP/openmake_llm/backend/api/src/auth/index.ts"],"sourcesContent":["/**\n * ì¸ì¦ ëª¨ë“ˆ\n * JWT í† í° ìƒì„±/ê²€ì¦ ë° ì¸ì¦ ìœ í‹¸ë¦¬í‹°\n * \n * #8 ì—°ë™: í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸ (PostgreSQL-backed) í†µí•©\n */\n\nimport * as jwt from 'jsonwebtoken';\nimport type { Response } from 'express';\nimport { JWTPayload } from './types';\nimport { PublicUser, UserRole } from '../data/user-manager';\nimport * as crypto from 'crypto';\nimport { getTokenBlacklist } from '../data/models/token-blacklist';\nimport { getConfig } from '../config/env';\n\n// JWT ë¹„ë°€í‚¤ (í™˜ê²½ë³€ìˆ˜ í•„ìˆ˜)\n// ë³´ì•ˆ: ëŸ°íƒ€ì„ ì‹œí¬ë¦¿ ìƒì„±ì€ ìˆ˜í‰ í™•ì¥ ì‹œ ë…¸ë“œ ê°„ ë¶ˆì¼ì¹˜ë¥¼ ìœ ë°œí•˜ë¯€ë¡œ ì œê±°\nconst JWT_SECRET = getConfig().jwtSecret;\nconst JWT_EXPIRES_IN = '15m';  // Access token - short lived for security\nconst REFRESH_TOKEN_EXPIRES_IN = '7d';  // Refresh token - longer lived\n\n// JWT_SECRET ë¯¸ì„¤ì • ì‹œ ëª¨ë“  í™˜ê²½ì—ì„œ ì—ëŸ¬ (í…ŒìŠ¤íŠ¸ í™˜ê²½ ì œì™¸)\nif (!JWT_SECRET) {\n    if (getConfig().nodeEnv === 'test') {\n        // í…ŒìŠ¤íŠ¸ í™˜ê²½ì—ì„œëŠ” ê²½ê³ ë§Œ (í…ŒìŠ¤íŠ¸ í”„ë ˆì„ì›Œí¬ì—ì„œ ìì²´ ì„¤ì •)\n        console.warn('[Auth] âš ï¸ JWT_SECRETì´ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤ (í…ŒìŠ¤íŠ¸ í™˜ê²½)');\n    } else {\n        console.error('[Auth] âŒ JWT_SECRET í™˜ê²½ë³€ìˆ˜ê°€ ì„¤ì •ë˜ì§€ ì•Šì•˜ìŠµë‹ˆë‹¤!');\n        console.error('[Auth] .env íŒŒì¼ì— JWT_SECRETì„ ë°˜ë“œì‹œ ì„¤ì •í•˜ì„¸ìš”.');\n        console.error('[Auth] ì˜ˆ: JWT_SECRET=$(openssl rand -hex 32)');\n        throw new Error('[Auth] JWT_SECRET í™˜ê²½ë³€ìˆ˜ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤. .env íŒŒì¼ì— ì„¤ì •í•˜ì„¸ìš”.');\n    }\n}\n\n\n/**\n * JWT ì•¡ì„¸ìŠ¤ í† í° ìƒì„±\n * #8 ì—°ë™: jti (JWT ID) ì¶”ê°€ë¡œ ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì§€ì›\n */\nexport function generateToken(user: PublicUser): string {\n    const payload: JWTPayload = {\n        userId: user.id,\n        email: user.email,\n        role: user.role\n    };\n\n    // jti(JWT ID)ë¥¼ ì¶”ê°€í•˜ì—¬ í† í° ë‹¨ìœ„ ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì§€ì›\n    const jti = crypto.randomBytes(16).toString('hex');\n\n    return jwt.sign(payload, JWT_SECRET, { \n        expiresIn: JWT_EXPIRES_IN,\n        jwtid: jti\n    });\n}\n\n/**\n * ğŸ”’ Phase 2 ë³´ì•ˆ íŒ¨ì¹˜: JWT ë¦¬í”„ë ˆì‹œ í† í° ìƒì„±\n * \n * ì•¡ì„¸ìŠ¤ í† í°(15ë¶„)ì´ ë§Œë£Œëœ í›„ ìƒˆ ì•¡ì„¸ìŠ¤ í† í°ì„ ë°œê¸‰ë°›ê¸° ìœ„í•œ ì¥ê¸° í† í°ì…ë‹ˆë‹¤.\n * - ë§Œë£Œ: 7ì¼\n * - jti í¬í•¨ (ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì§€ì›)\n * - type: 'refresh' í•„ë“œë¡œ ì•¡ì„¸ìŠ¤ í† í°ê³¼ êµ¬ë¶„\n */\nexport function generateRefreshToken(user: PublicUser): string {\n    const payload = {\n        userId: user.id,\n        email: user.email,\n        role: user.role,\n        type: 'refresh' as const\n    };\n\n    const jti = crypto.randomBytes(16).toString('hex');\n\n    return jwt.sign(payload, JWT_SECRET, {\n        expiresIn: REFRESH_TOKEN_EXPIRES_IN,\n        jwtid: jti\n    });\n}\n\n/**\n * ğŸ”’ Phase 2: ë¦¬í”„ë ˆì‹œ í† í° ê²€ì¦\n * ì•¡ì„¸ìŠ¤ í† í° ê°±ì‹ ìš© ë¦¬í”„ë ˆì‹œ í† í°ì„ ê²€ì¦í•©ë‹ˆë‹¤.\n * \n * @returns ê²€ì¦ëœ í˜ì´ë¡œë“œ ë˜ëŠ” null\n */\nexport async function verifyRefreshToken(token: string): Promise<JWTPayload | null> {\n    try {\n        // ë¸”ë™ë¦¬ìŠ¤íŠ¸ í™•ì¸\n        const preCheck = jwt.decode(token) as Record<string, unknown> | null;\n        if (preCheck?.jti && typeof preCheck.jti === 'string') {\n            try {\n                const blacklist = getTokenBlacklist();\n                if (await blacklist.has(preCheck.jti)) {\n                    console.warn('[Auth] ë¸”ë™ë¦¬ìŠ¤íŠ¸ëœ ë¦¬í”„ë ˆì‹œ í† í° ì‚¬ìš© ì‹œë„');\n                    return null;\n                }\n            } catch {\n                // ë¸”ë™ë¦¬ìŠ¤íŠ¸ DB ì ‘ê·¼ ì‹¤íŒ¨ ì‹œ ë¬´ì‹œ (ê°€ìš©ì„± ìš°ì„ )\n            }\n        }\n\n        // typeì´ 'refresh'ì¸ì§€ í™•ì¸\n        if (preCheck?.type !== 'refresh') {\n            console.warn('[Auth] ë¦¬í”„ë ˆì‹œ í† í°ì´ ì•„ë‹Œ í† í°ìœ¼ë¡œ ê°±ì‹  ì‹œë„');\n            return null;\n        }\n\n        const decoded = jwt.verify(token, JWT_SECRET) as unknown as JWTPayload;\n        return decoded;\n    } catch (error) {\n        console.error('[Auth] ë¦¬í”„ë ˆì‹œ í† í° ê²€ì¦ ì‹¤íŒ¨:', error);\n        return null;\n    }\n}\n\n/**\n * JWT í† í° ê²€ì¦\n * #8 ì—°ë™: ë¸”ë™ë¦¬ìŠ¤íŠ¸ í™•ì¸ ì¶”ê°€\n */\nexport async function verifyToken(token: string): Promise<JWTPayload | null> {\n    try {\n        // ë¸”ë™ë¦¬ìŠ¤íŠ¸ í™•ì¸ (jti ê¸°ë°˜)\n        const preCheck = jwt.decode(token) as Record<string, unknown> | null;\n        if (preCheck?.jti && typeof preCheck.jti === 'string') {\n            try {\n                const blacklist = getTokenBlacklist();\n                if (await blacklist.has(preCheck.jti)) {\n                    console.warn('[Auth] ë¸”ë™ë¦¬ìŠ¤íŠ¸ëœ í† í° ì‚¬ìš© ì‹œë„');\n                    return null;\n                }\n            } catch {\n                // ë¸”ë™ë¦¬ìŠ¤íŠ¸ DB ì ‘ê·¼ ì‹¤íŒ¨ ì‹œ ë¬´ì‹œ (ê°€ìš©ì„± ìš°ì„ )\n            }\n        }\n\n        const decoded = jwt.verify(token, JWT_SECRET) as unknown as JWTPayload;\n        return decoded;\n    } catch (error) {\n        console.error('[Auth] í† í° ê²€ì¦ ì‹¤íŒ¨:', error);\n        return null;\n    }\n}\n\n/**\n * í† í°ì„ ë¸”ë™ë¦¬ìŠ¤íŠ¸ì— ì¶”ê°€ (ë¡œê·¸ì•„ì›ƒ ì‹œ í˜¸ì¶œ)\n * #8 ì—°ë™: PostgreSQL ê¸°ë°˜ ì˜ì† ë¸”ë™ë¦¬ìŠ¤íŠ¸\n */\nexport async function blacklistToken(token: string): Promise<boolean> {\n    try {\n        const decoded = jwt.decode(token) as Record<string, unknown> | null;\n        if (!decoded?.jti || typeof decoded.jti !== 'string') {\n            // jti ì—†ëŠ” ë ˆê±°ì‹œ í† í° â€” ë¸”ë™ë¦¬ìŠ¤íŠ¸ ë¶ˆê°€\n            return false;\n        }\n        const expiresAt = typeof decoded.exp === 'number' \n            ? decoded.exp * 1000 \n            : Date.now() + 15 * 60 * 1000; // ê¸°ë³¸ 15ë¶„\n        \n        const blacklist = getTokenBlacklist();\n        await blacklist.add(decoded.jti, expiresAt);\n        console.log(`[Auth] ğŸš« í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì¶”ê°€: ${decoded.jti.substring(0, 8)}...`);\n        return true;\n    } catch (error) {\n        console.error('[Auth] í† í° ë¸”ë™ë¦¬ìŠ¤íŠ¸ ì¶”ê°€ ì‹¤íŒ¨:', error);\n        return false;\n    }\n}\n\n/**\n * Authorization í—¤ë”ì—ì„œ í† í° ì¶”ì¶œ\n */\nexport function extractToken(authHeader?: string): string | null {\n    if (!authHeader) return null;\n\n    // \"Bearer <token>\" í˜•ì‹\n    if (authHeader.startsWith('Bearer ')) {\n        return authHeader.slice(7);\n    }\n\n    return authHeader;\n}\n\n/**\n * ì—­í•  ê¶Œí•œ ì²´í¬\n */\nexport function hasPermission(userRole: UserRole, requiredRole: UserRole): boolean {\n    const roleHierarchy: Record<UserRole, number> = {\n        'admin': 3,\n        'user': 2,\n        'guest': 1\n    };\n\n    return roleHierarchy[userRole] >= roleHierarchy[requiredRole];\n}\n\n/**\n * ê´€ë¦¬ì ì—¬ë¶€ í™•ì¸\n */\nexport function isAdmin(role: UserRole): boolean {\n    return role === 'admin';\n}\n\n// ëª¨ë“ˆ ì¬-export\nexport * from './types';\nexport { optionalAuth, requireAuth, requireAdmin, requireRole } from './middleware';\n\n/**\n * í† í°ì„ httpOnly ì¿ í‚¤ì— ì„¤ì •\n * ğŸ”’ Phase 2: ì•¡ì„¸ìŠ¤ í† í° ì¿ í‚¤ (15ë¶„ ë§Œë£Œ)\n */\nexport function setTokenCookie(res: Response, token: string): void {\n    res.cookie('auth_token', token, {\n        httpOnly: true,\n        secure: getConfig().nodeEnv === 'production',\n        sameSite: 'lax',\n        maxAge: 15 * 60 * 1000, // 15ë¶„ (ì•¡ì„¸ìŠ¤ í† í° ìˆ˜ëª…ê³¼ ì¼ì¹˜)\n        path: '/'\n    });\n}\n\n/**\n * ğŸ”’ Phase 2: ë¦¬í”„ë ˆì‹œ í† í°ì„ httpOnly ì¿ í‚¤ì— ì„¤ì • (7ì¼ ë§Œë£Œ)\n */\nexport function setRefreshTokenCookie(res: Response, refreshToken: string): void {\n    res.cookie('refresh_token', refreshToken, {\n        httpOnly: true,\n        secure: getConfig().nodeEnv === 'production',\n        sameSite: 'lax',\n        maxAge: 7 * 24 * 60 * 60 * 1000, // 7ì¼\n        path: '/api/auth/refresh' // ë¦¬í”„ë ˆì‹œ ì—”ë“œí¬ì¸íŠ¸ì—ì„œë§Œ ì „ì†¡\n    });\n}\n\n/**\n * í† í° ì¿ í‚¤ ì‚­ì œ\n * ğŸ”’ Phase 2: ì•¡ì„¸ìŠ¤ + ë¦¬í”„ë ˆì‹œ ì¿ í‚¤ ëª¨ë‘ ì‚­ì œ\n */\nexport function clearTokenCookie(res: Response): void {\n    res.clearCookie('auth_token', { path: '/' });\n    res.clearCookie('refresh_token', { path: '/api/auth/refresh' });\n}\n"],"version":3}