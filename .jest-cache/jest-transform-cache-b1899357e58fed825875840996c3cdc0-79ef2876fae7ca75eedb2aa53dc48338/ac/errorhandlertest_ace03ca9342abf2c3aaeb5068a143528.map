{"file":"/Volumes/MAC_APP/openmake_llm/backend/api/src/__tests__/error-handler.test.ts","mappings":"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","names":[],"sources":["/Volumes/MAC_APP/openmake_llm/backend/api/src/__tests__/error-handler.test.ts"],"sourcesContent":["/**\n * Error Handler Tests\n */\nimport { AppError, ValidationError, AuthenticationError, AuthorizationError, NotFoundError, RateLimitError, DatabaseError, errorHandler, asyncHandler, notFoundHandler } from '../utils/error-handler';\nimport { Request, Response, NextFunction } from 'express';\n\n// Mock logger\njest.mock('../utils/logger', () => ({\n    createLogger: () => ({\n        error: jest.fn(),\n        info: jest.fn(),\n        warn: jest.fn(),\n        debug: jest.fn()\n    })\n}));\n\ndescribe('Error Handler', () => {\n    // Test all error classes\n    describe('AppError classes', () => {\n        it('should create AppError with correct properties', () => {\n            const error = new AppError('Test error', 500, true, 'TEST_ERROR');\n            expect(error.message).toBe('Test error');\n            expect(error.statusCode).toBe(500);\n            expect(error.isOperational).toBe(true);\n            expect(error.code).toBe('TEST_ERROR');\n        });\n\n        it('should create ValidationError with 400 status', () => {\n            const error = new ValidationError('Invalid input');\n            expect(error.message).toBe('Invalid input');\n            expect(error.statusCode).toBe(400);\n            expect(error.code).toBe('VALIDATION_ERROR');\n            expect(error.isOperational).toBe(true);\n        });\n\n        it('should create AuthenticationError with 401 status', () => {\n            const error = new AuthenticationError('Not authenticated');\n            expect(error.message).toBe('Not authenticated');\n            expect(error.statusCode).toBe(401);\n            expect(error.code).toBe('AUTHENTICATION_ERROR');\n            expect(error.isOperational).toBe(true);\n        });\n\n        it('should create AuthenticationError with default message', () => {\n            const error = new AuthenticationError();\n            expect(error.message).toBe('인증이 필요합니다');\n            expect(error.statusCode).toBe(401);\n        });\n\n        it('should create AuthorizationError with 403 status', () => {\n            const error = new AuthorizationError('Access denied');\n            expect(error.message).toBe('Access denied');\n            expect(error.statusCode).toBe(403);\n            expect(error.code).toBe('AUTHORIZATION_ERROR');\n            expect(error.isOperational).toBe(true);\n        });\n\n        it('should create AuthorizationError with default message', () => {\n            const error = new AuthorizationError();\n            expect(error.message).toBe('권한이 없습니다');\n            expect(error.statusCode).toBe(403);\n        });\n\n        it('should create NotFoundError with 404 status', () => {\n            const error = new NotFoundError('Resource not found');\n            expect(error.message).toBe('Resource not found');\n            expect(error.statusCode).toBe(404);\n            expect(error.code).toBe('NOT_FOUND');\n            expect(error.isOperational).toBe(true);\n        });\n\n        it('should create NotFoundError with default message', () => {\n            const error = new NotFoundError();\n            expect(error.message).toBe('리소스를 찾을 수 없습니다');\n            expect(error.statusCode).toBe(404);\n        });\n\n        it('should create RateLimitError with 429 status', () => {\n            const error = new RateLimitError('Too many requests');\n            expect(error.message).toBe('Too many requests');\n            expect(error.statusCode).toBe(429);\n            expect(error.code).toBe('RATE_LIMIT_EXCEEDED');\n            expect(error.isOperational).toBe(true);\n        });\n\n        it('should create RateLimitError with default message', () => {\n            const error = new RateLimitError();\n            expect(error.message).toBe('요청 제한을 초과했습니다');\n            expect(error.statusCode).toBe(429);\n        });\n\n        it('should create DatabaseError with 500 status', () => {\n            const error = new DatabaseError('Database connection failed');\n            expect(error.message).toBe('Database connection failed');\n            expect(error.statusCode).toBe(500);\n            expect(error.code).toBe('DATABASE_ERROR');\n            expect(error.isOperational).toBe(true);\n        });\n\n        it('should create DatabaseError with default message', () => {\n            const error = new DatabaseError();\n            expect(error.message).toBe('데이터베이스 오류가 발생했습니다');\n            expect(error.statusCode).toBe(500);\n        });\n    });\n\n    describe('errorHandler middleware', () => {\n        let mockReq: Partial<Request>;\n        let mockRes: Partial<Response>;\n        let mockNext: NextFunction;\n\n        beforeEach(() => {\n            mockReq = {\n                method: 'GET',\n                path: '/test',\n                body: {},\n                query: {}\n            };\n            mockRes = {\n                status: jest.fn().mockReturnThis(),\n                json: jest.fn().mockReturnThis()\n            };\n            mockNext = jest.fn();\n        });\n\n        it('should handle AppError and return correct status', () => {\n            const error = new ValidationError('Invalid data');\n            errorHandler(error, mockReq as Request, mockRes as Response, mockNext);\n\n            expect(mockRes.status).toHaveBeenCalledWith(400);\n            expect(mockRes.json).toHaveBeenCalled();\n            const response = (mockRes.json as jest.Mock).mock.calls[0][0];\n            expect(response.success).toBe(false);\n            expect(response.error).toBe('Invalid data');\n            expect(response.code).toBe('VALIDATION_ERROR');\n        });\n\n        it('should handle unknown errors as 500', () => {\n            const error = new Error('Unknown error');\n            errorHandler(error, mockReq as Request, mockRes as Response, mockNext);\n\n            expect(mockRes.status).toHaveBeenCalledWith(500);\n            expect(mockRes.json).toHaveBeenCalled();\n            const response = (mockRes.json as jest.Mock).mock.calls[0][0];\n            expect(response.success).toBe(false);\n            expect(response.error).toBe('Unknown error');\n        });\n\n        it('should include stack in dev environment', () => {\n            const originalEnv = process.env.NODE_ENV;\n            process.env.NODE_ENV = 'development';\n\n            const error = new AppError('Dev error', 500);\n            errorHandler(error, mockReq as Request, mockRes as Response, mockNext);\n\n            const response = (mockRes.json as jest.Mock).mock.calls[0][0];\n            expect(response.stack).toBeDefined();\n\n            process.env.NODE_ENV = originalEnv;\n        });\n\n        it('should not include stack in production environment', () => {\n            const originalEnv = process.env.NODE_ENV;\n            process.env.NODE_ENV = 'production';\n\n            const error = new AppError('Prod error', 500);\n            errorHandler(error, mockReq as Request, mockRes as Response, mockNext);\n\n            const response = (mockRes.json as jest.Mock).mock.calls[0][0];\n            expect(response.stack).toBeUndefined();\n\n            process.env.NODE_ENV = originalEnv;\n        });\n\n        it('should include timestamp in response', () => {\n            const error = new AppError('Test error', 500);\n            errorHandler(error, mockReq as Request, mockRes as Response, mockNext);\n\n            const response = (mockRes.json as jest.Mock).mock.calls[0][0];\n            expect(response.timestamp).toBeDefined();\n            expect(typeof response.timestamp).toBe('string');\n        });\n    });\n\n    describe('asyncHandler', () => {\n        let mockReq: Partial<Request>;\n        let mockRes: Partial<Response>;\n        let mockNext: NextFunction;\n\n        beforeEach(() => {\n            mockReq = {};\n            mockRes = {};\n            mockNext = jest.fn();\n        });\n\n        it('should pass resolved promise to next handler', async () => {\n            const handler = asyncHandler(async (req, res, next) => {\n                res.json = jest.fn().mockReturnValue({ success: true });\n                return { success: true };\n            });\n\n            handler(mockReq as Request, mockRes as Response, mockNext);\n\n            // Give async handler time to resolve\n            await new Promise(resolve => setTimeout(resolve, 10));\n            expect(mockNext).not.toHaveBeenCalled();\n        });\n\n        it('should catch rejected promise and call next', async () => {\n            const testError = new Error('Async error');\n            const handler = asyncHandler(async (req, res, next) => {\n                throw testError;\n            });\n\n            handler(mockReq as Request, mockRes as Response, mockNext);\n\n            // Give async handler time to reject\n            await new Promise(resolve => setTimeout(resolve, 10));\n            expect(mockNext).toHaveBeenCalledWith(testError);\n        });\n\n        it('should handle synchronous errors in async function', async () => {\n            const testError = new ValidationError('Sync error in async');\n            const handler = asyncHandler(async (req, res, next) => {\n                throw testError;\n            });\n\n            handler(mockReq as Request, mockRes as Response, mockNext);\n\n            await new Promise(resolve => setTimeout(resolve, 10));\n            expect(mockNext).toHaveBeenCalledWith(testError);\n        });\n    });\n\n    describe('notFoundHandler', () => {\n        let mockReq: Partial<Request>;\n        let mockRes: Partial<Response>;\n        let mockNext: NextFunction;\n\n        beforeEach(() => {\n            mockReq = {\n                method: 'POST',\n                path: '/api/nonexistent'\n            };\n            mockRes = {};\n            mockNext = jest.fn();\n        });\n\n        it('should create NotFoundError with route info', () => {\n            notFoundHandler(mockReq as Request, mockRes as Response, mockNext);\n\n            expect(mockNext).toHaveBeenCalled();\n            const error = (mockNext as jest.Mock).mock.calls[0][0];\n            expect(error).toBeInstanceOf(NotFoundError);\n            expect(error.message).toContain('POST');\n            expect(error.message).toContain('/api/nonexistent');\n        });\n\n        it('should pass error to next middleware', () => {\n            notFoundHandler(mockReq as Request, mockRes as Response, mockNext);\n\n            expect(mockNext).toHaveBeenCalledTimes(1);\n            const error = (mockNext as jest.Mock).mock.calls[0][0];\n            expect(error).toBeInstanceOf(NotFoundError);\n        });\n    });\n});\n"],"version":3}