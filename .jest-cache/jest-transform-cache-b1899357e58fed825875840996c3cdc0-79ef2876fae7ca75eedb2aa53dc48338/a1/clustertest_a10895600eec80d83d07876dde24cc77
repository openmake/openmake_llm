92f05adb2c414b5094aaefca81c31581
"use strict";
/**
 * Cluster Manager Tests
 */
Object.defineProperty(exports, "__esModule", { value: true });
const manager_1 = require("../../../backend/api/src/cluster/manager");
describe('ClusterManager', () => {
    let manager;
    beforeEach(() => {
        manager = new manager_1.ClusterManager({
            name: 'test-cluster',
            nodes: [],
            heartbeatInterval: 10000
        });
    });
    afterEach(() => {
        manager.stop();
    });
    describe('constructor', () => {
        it('should create a cluster manager with unique id', () => {
            expect(manager.id).toBeDefined();
            expect(typeof manager.id).toBe('string');
        });
        it('should have empty nodes by default', () => {
            expect(manager.getNodes()).toEqual([]);
        });
    });
    describe('getStats', () => {
        it('should return correct initial stats', () => {
            const stats = manager.getStats();
            expect(stats.totalNodes).toBe(0);
            expect(stats.onlineNodes).toBe(0);
            expect(stats.totalModels).toBe(0);
            expect(stats.uniqueModels).toEqual([]);
        });
    });
    describe('getOnlineNodes', () => {
        it('should return empty array when no nodes', () => {
            expect(manager.getOnlineNodes()).toEqual([]);
        });
    });
    describe('getBestNode', () => {
        it('should return undefined when no nodes available', () => {
            expect(manager.getBestNode()).toBeUndefined();
        });
        it('should return undefined when no nodes with specified model', () => {
            expect(manager.getBestNode('non-existent-model')).toBeUndefined();
        });
    });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJmaWxlIjoiL1ZvbHVtZXMvTUFDX0FQUC9vcGVubWFrZV9sbG0vdGVzdHMvdW5pdC9fX3Rlc3RzX18vY2x1c3Rlci50ZXN0LnRzIiwibWFwcGluZ3MiOiI7QUFBQTs7R0FFRzs7QUFFSCxzRUFBMEU7QUFFMUUsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtJQUM1QixJQUFJLE9BQXVCLENBQUM7SUFFNUIsVUFBVSxDQUFDLEdBQUcsRUFBRTtRQUNaLE9BQU8sR0FBRyxJQUFJLHdCQUFjLENBQUM7WUFDekIsSUFBSSxFQUFFLGNBQWM7WUFDcEIsS0FBSyxFQUFFLEVBQUU7WUFDVCxpQkFBaUIsRUFBRSxLQUFLO1NBQzNCLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsU0FBUyxDQUFDLEdBQUcsRUFBRTtRQUNYLE9BQU8sQ0FBQyxJQUFJLEVBQUUsQ0FBQztJQUNuQixDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyxnREFBZ0QsRUFBRSxHQUFHLEVBQUU7WUFDdEQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQyxXQUFXLEVBQUUsQ0FBQztZQUNqQyxNQUFNLENBQUMsT0FBTyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUMsSUFBSSxDQUFDLFFBQVEsQ0FBQyxDQUFDO1FBQzdDLENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLG9DQUFvQyxFQUFFLEdBQUcsRUFBRTtZQUMxQyxNQUFNLENBQUMsT0FBTyxDQUFDLFFBQVEsRUFBRSxDQUFDLENBQUMsT0FBTyxDQUFDLEVBQUUsQ0FBQyxDQUFDO1FBQzNDLENBQUMsQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxRQUFRLENBQUMsVUFBVSxFQUFFLEdBQUcsRUFBRTtRQUN0QixFQUFFLENBQUMscUNBQXFDLEVBQUUsR0FBRyxFQUFFO1lBQzNDLE1BQU0sS0FBSyxHQUFHLE9BQU8sQ0FBQyxRQUFRLEVBQUUsQ0FBQztZQUVqQyxNQUFNLENBQUMsS0FBSyxDQUFDLFVBQVUsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNqQyxNQUFNLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsS0FBSyxDQUFDLFdBQVcsQ0FBQyxDQUFDLElBQUksQ0FBQyxDQUFDLENBQUMsQ0FBQztZQUNsQyxNQUFNLENBQUMsS0FBSyxDQUFDLFlBQVksQ0FBQyxDQUFDLE9BQU8sQ0FBQyxFQUFFLENBQUMsQ0FBQztRQUMzQyxDQUFDLENBQUMsQ0FBQztJQUNQLENBQUMsQ0FBQyxDQUFDO0lBRUgsUUFBUSxDQUFDLGdCQUFnQixFQUFFLEdBQUcsRUFBRTtRQUM1QixFQUFFLENBQUMseUNBQXlDLEVBQUUsR0FBRyxFQUFFO1lBQy9DLE1BQU0sQ0FBQyxPQUFPLENBQUMsY0FBYyxFQUFFLENBQUMsQ0FBQyxPQUFPLENBQUMsRUFBRSxDQUFDLENBQUM7UUFDakQsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILFFBQVEsQ0FBQyxhQUFhLEVBQUUsR0FBRyxFQUFFO1FBQ3pCLEVBQUUsQ0FBQyxpREFBaUQsRUFBRSxHQUFHLEVBQUU7WUFDdkQsTUFBTSxDQUFDLE9BQU8sQ0FBQyxXQUFXLEVBQUUsQ0FBQyxDQUFDLGFBQWEsRUFBRSxDQUFDO1FBQ2xELENBQUMsQ0FBQyxDQUFDO1FBRUgsRUFBRSxDQUFDLDREQUE0RCxFQUFFLEdBQUcsRUFBRTtZQUNsRSxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLENBQUMsYUFBYSxFQUFFLENBQUM7UUFDdEUsQ0FBQyxDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztBQUNQLENBQUMsQ0FBQyxDQUFDIiwibmFtZXMiOltdLCJzb3VyY2VzIjpbIi9Wb2x1bWVzL01BQ19BUFAvb3Blbm1ha2VfbGxtL3Rlc3RzL3VuaXQvX190ZXN0c19fL2NsdXN0ZXIudGVzdC50cyJdLCJzb3VyY2VzQ29udGVudCI6WyIvKipcbiAqIENsdXN0ZXIgTWFuYWdlciBUZXN0c1xuICovXG5cbmltcG9ydCB7IENsdXN0ZXJNYW5hZ2VyIH0gZnJvbSAnLi4vLi4vLi4vYmFja2VuZC9hcGkvc3JjL2NsdXN0ZXIvbWFuYWdlcic7XG5cbmRlc2NyaWJlKCdDbHVzdGVyTWFuYWdlcicsICgpID0+IHtcbiAgICBsZXQgbWFuYWdlcjogQ2x1c3Rlck1hbmFnZXI7XG5cbiAgICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICAgICAgbWFuYWdlciA9IG5ldyBDbHVzdGVyTWFuYWdlcih7XG4gICAgICAgICAgICBuYW1lOiAndGVzdC1jbHVzdGVyJyxcbiAgICAgICAgICAgIG5vZGVzOiBbXSxcbiAgICAgICAgICAgIGhlYXJ0YmVhdEludGVydmFsOiAxMDAwMFxuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGFmdGVyRWFjaCgoKSA9PiB7XG4gICAgICAgIG1hbmFnZXIuc3RvcCgpO1xuICAgIH0pO1xuXG4gICAgZGVzY3JpYmUoJ2NvbnN0cnVjdG9yJywgKCkgPT4ge1xuICAgICAgICBpdCgnc2hvdWxkIGNyZWF0ZSBhIGNsdXN0ZXIgbWFuYWdlciB3aXRoIHVuaXF1ZSBpZCcsICgpID0+IHtcbiAgICAgICAgICAgIGV4cGVjdChtYW5hZ2VyLmlkKS50b0JlRGVmaW5lZCgpO1xuICAgICAgICAgICAgZXhwZWN0KHR5cGVvZiBtYW5hZ2VyLmlkKS50b0JlKCdzdHJpbmcnKTtcbiAgICAgICAgfSk7XG5cbiAgICAgICAgaXQoJ3Nob3VsZCBoYXZlIGVtcHR5IG5vZGVzIGJ5IGRlZmF1bHQnLCAoKSA9PiB7XG4gICAgICAgICAgICBleHBlY3QobWFuYWdlci5nZXROb2RlcygpKS50b0VxdWFsKFtdKTtcbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICBkZXNjcmliZSgnZ2V0U3RhdHMnLCAoKSA9PiB7XG4gICAgICAgIGl0KCdzaG91bGQgcmV0dXJuIGNvcnJlY3QgaW5pdGlhbCBzdGF0cycsICgpID0+IHtcbiAgICAgICAgICAgIGNvbnN0IHN0YXRzID0gbWFuYWdlci5nZXRTdGF0cygpO1xuXG4gICAgICAgICAgICBleHBlY3Qoc3RhdHMudG90YWxOb2RlcykudG9CZSgwKTtcbiAgICAgICAgICAgIGV4cGVjdChzdGF0cy5vbmxpbmVOb2RlcykudG9CZSgwKTtcbiAgICAgICAgICAgIGV4cGVjdChzdGF0cy50b3RhbE1vZGVscykudG9CZSgwKTtcbiAgICAgICAgICAgIGV4cGVjdChzdGF0cy51bmlxdWVNb2RlbHMpLnRvRXF1YWwoW10pO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdnZXRPbmxpbmVOb2RlcycsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gZW1wdHkgYXJyYXkgd2hlbiBubyBub2RlcycsICgpID0+IHtcbiAgICAgICAgICAgIGV4cGVjdChtYW5hZ2VyLmdldE9ubGluZU5vZGVzKCkpLnRvRXF1YWwoW10pO1xuICAgICAgICB9KTtcbiAgICB9KTtcblxuICAgIGRlc2NyaWJlKCdnZXRCZXN0Tm9kZScsICgpID0+IHtcbiAgICAgICAgaXQoJ3Nob3VsZCByZXR1cm4gdW5kZWZpbmVkIHdoZW4gbm8gbm9kZXMgYXZhaWxhYmxlJywgKCkgPT4ge1xuICAgICAgICAgICAgZXhwZWN0KG1hbmFnZXIuZ2V0QmVzdE5vZGUoKSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgICB9KTtcblxuICAgICAgICBpdCgnc2hvdWxkIHJldHVybiB1bmRlZmluZWQgd2hlbiBubyBub2RlcyB3aXRoIHNwZWNpZmllZCBtb2RlbCcsICgpID0+IHtcbiAgICAgICAgICAgIGV4cGVjdChtYW5hZ2VyLmdldEJlc3ROb2RlKCdub24tZXhpc3RlbnQtbW9kZWwnKSkudG9CZVVuZGVmaW5lZCgpO1xuICAgICAgICB9KTtcbiAgICB9KTtcbn0pO1xuIl0sInZlcnNpb24iOjN9