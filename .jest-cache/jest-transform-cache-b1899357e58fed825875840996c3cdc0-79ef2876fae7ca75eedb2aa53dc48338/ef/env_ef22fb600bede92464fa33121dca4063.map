{"file":"/Volumes/MAC_APP/openmake_llm/backend/api/src/config/env.ts","mappings":"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","names":[],"sources":["/Volumes/MAC_APP/openmake_llm/backend/api/src/config/env.ts"],"sourcesContent":["// 환경 설정 로더\nimport * as fs from 'fs';\nimport * as path from 'path';\n\nexport interface EnvConfig {\n    // Node\n    nodeEnv: string;\n\n    // Server\n    port: number;\n    serverHost: string;\n\n    // Database\n    databaseUrl: string;\n\n    // Auth\n    jwtSecret: string;\n    adminPassword: string;\n    defaultAdminEmail: string;\n    adminEmails: string;\n\n    // OAuth\n    googleClientId: string;\n    googleClientSecret: string;\n    githubClientId: string;\n    githubClientSecret: string;\n    oauthRedirectUri: string;\n\n    // CORS\n    corsOrigins: string;\n\n    // Ollama\n    ollamaBaseUrl: string;\n    ollamaDefaultModel: string;\n    ollamaKoreanModel: string;\n    ollamaModel: string;\n    ollamaTimeout: number;\n    ollamaHost: string;\n    ollamaApiKey: string;\n    ollamaApiKeyPrimary: string;\n    ollamaApiKeySecondary: string;\n    ollamaSshKey: string;\n    ollamaModels: string[];  // Per-key models (OLLAMA_MODEL_1, _2, etc.)\n\n    // Rate limits\n    ollamaHourlyLimit: number;\n    ollamaWeeklyLimit: number;\n    ollamaMonthlyPremiumLimit: number;\n\n    // Log\n    logLevel: 'debug' | 'info' | 'warn' | 'error';\n\n    // Gemini\n    geminiThinkEnabled: boolean;\n    geminiThinkLevel: 'low' | 'medium' | 'high';\n    geminiNumCtx: number;\n    geminiEmbeddingModel: string;\n    geminiWebSearchEnabled: boolean;\n\n    // External services\n    googleApiKey: string;\n    googleCseId: string;\n    firecrawlApiKey: string;\n    firecrawlApiUrl: string;\n\n    // Documents\n    documentTtlHours: number;\n    maxUploadedDocuments: number;\n\n    // Conversations\n    maxConversationSessions: number;\n    sessionTtlDays: number;\n\n    // User data\n    userDataPath: string;\n\n    // Push notifications (VAPID)\n    vapidPublicKey: string;\n    vapidPrivateKey: string;\n    vapidSubject: string;\n\n    // Swagger\n    swaggerBaseUrl: string;\n}\n\nconst DEFAULT_CONFIG: EnvConfig = {\n    // Node\n    nodeEnv: 'development',\n\n    // Server\n    port: 52416,\n    serverHost: '0.0.0.0',\n\n    // Database\n    databaseUrl: 'postgresql://localhost:5432/openmake_llm',\n\n    // Auth\n    jwtSecret: '',\n    adminPassword: '',\n    defaultAdminEmail: 'admin@localhost',\n    adminEmails: '',\n\n    // OAuth\n    googleClientId: '',\n    googleClientSecret: '',\n    githubClientId: '',\n    githubClientSecret: '',\n    oauthRedirectUri: 'http://localhost:52416/api/auth/callback/google',\n\n    // CORS\n    corsOrigins: 'http://localhost:52416',\n\n    // Ollama\n    ollamaBaseUrl: 'http://localhost:11434',\n    ollamaDefaultModel: 'gemini-3-flash-preview:cloud',\n    ollamaKoreanModel: 'gemini-3-flash-preview:cloud',\n    ollamaModel: 'gemini-3-flash-preview:cloud',\n    ollamaTimeout: 120000,\n    ollamaHost: 'http://localhost:11434',\n    ollamaApiKey: '',\n    ollamaApiKeyPrimary: '',\n    ollamaApiKeySecondary: '',\n    ollamaSshKey: '',\n    ollamaModels: [],  // Per-key models\n\n    // Rate limits\n    ollamaHourlyLimit: 150,\n    ollamaWeeklyLimit: 2500,\n    ollamaMonthlyPremiumLimit: 5,\n\n    // Log\n    logLevel: 'info',\n\n    // Gemini\n    geminiThinkEnabled: true,\n    geminiThinkLevel: 'high' as const,\n    geminiNumCtx: 32768,\n    geminiEmbeddingModel: 'gemini-3-flash-preview:cloud',\n    geminiWebSearchEnabled: true,\n\n    // External services\n    googleApiKey: '',\n    googleCseId: '',\n    firecrawlApiKey: '',\n    firecrawlApiUrl: 'https://api.firecrawl.dev/v1',\n\n    // Documents\n    documentTtlHours: 1,\n    maxUploadedDocuments: 100,\n\n    // Conversations\n    maxConversationSessions: 1000,\n    sessionTtlDays: 30,\n\n    // User data\n    userDataPath: './data/users',\n\n    // VAPID\n    vapidPublicKey: '',\n    vapidPrivateKey: '',\n    vapidSubject: 'mailto:admin@openmake.ai',\n\n    // Swagger\n    swaggerBaseUrl: '',\n};\n\nfunction parseEnvFile(filePath: string): Record<string, string> {\n    const env: Record<string, string> = {};\n\n    if (!fs.existsSync(filePath)) {\n        return env;\n    }\n\n    const content = fs.readFileSync(filePath, 'utf-8');\n    const lines = content.split('\\n');\n\n    for (const line of lines) {\n        const trimmed = line.trim();\n\n        // 빈 줄이나 주석 건너뛰기\n        if (!trimmed || trimmed.startsWith('#')) {\n            continue;\n        }\n\n        const equalIndex = trimmed.indexOf('=');\n        if (equalIndex > 0) {\n            const key = trimmed.substring(0, equalIndex).trim();\n            const value = trimmed.substring(equalIndex + 1).trim();\n            env[key] = value;\n        }\n    }\n\n    return env;\n}\n\nfunction parseLogLevel(value: string | undefined): 'debug' | 'info' | 'warn' | 'error' {\n    const level = (value || '').toLowerCase();\n    if (level === 'debug' || level === 'info' || level === 'warn' || level === 'error') {\n        return level;\n    }\n    return DEFAULT_CONFIG.logLevel;\n}\n\n/**\n * 필수 환경 변수 검증\n * 런타임 시작 전에 호출하여 설정 오류를 조기에 발견\n */\nexport function validateConfig(config: EnvConfig): void {\n    const errors: string[] = [];\n\n    // URL 검증\n    if (!config.ollamaBaseUrl || !config.ollamaBaseUrl.startsWith('http')) {\n        errors.push(`Invalid OLLAMA_BASE_URL: ${config.ollamaBaseUrl}`);\n    }\n\n    // 모델 이름 검증\n    if (!config.ollamaDefaultModel || config.ollamaDefaultModel.trim() === '') {\n        errors.push('OLLAMA_DEFAULT_MODEL is required');\n    }\n\n    // 타임아웃 검증\n    if (config.ollamaTimeout <= 0 || config.ollamaTimeout > 600000) {\n        errors.push(`Invalid OLLAMA_TIMEOUT: ${config.ollamaTimeout} (must be between 1-600000ms)`);\n    }\n\n    if (errors.length > 0) {\n        throw new Error(`Configuration validation failed:\\n${errors.join('\\n')}`);\n    }\n}\n\nexport function loadConfig(): EnvConfig {\n    // 프로젝트 루트에서 .env 파일 찾기\n    const envPath = path.resolve(process.cwd(), '.env');\n    const projectEnvPath = path.resolve(__dirname, '../../.env');\n\n    // 환경변수 우선순위: process.env > .env 파일 > 기본값\n    const fileEnv = parseEnvFile(fs.existsSync(envPath) ? envPath : projectEnvPath);\n\n    const env = (key: string): string | undefined => process.env[key] || fileEnv[key];\n\n    return {\n        // Node\n        nodeEnv: env('NODE_ENV') || DEFAULT_CONFIG.nodeEnv,\n\n        // Server\n        port: parseInt(env('PORT') || String(DEFAULT_CONFIG.port), 10),\n        serverHost: env('SERVER_HOST') || DEFAULT_CONFIG.serverHost,\n\n        // Database\n        databaseUrl: env('DATABASE_URL') || DEFAULT_CONFIG.databaseUrl,\n\n        // Auth\n        jwtSecret: env('JWT_SECRET') || DEFAULT_CONFIG.jwtSecret,\n        adminPassword: env('ADMIN_PASSWORD') || DEFAULT_CONFIG.adminPassword,\n        defaultAdminEmail: env('DEFAULT_ADMIN_EMAIL') || DEFAULT_CONFIG.defaultAdminEmail,\n        adminEmails: env('ADMIN_EMAILS') || DEFAULT_CONFIG.adminEmails,\n\n        // OAuth\n        googleClientId: env('GOOGLE_CLIENT_ID') || DEFAULT_CONFIG.googleClientId,\n        googleClientSecret: env('GOOGLE_CLIENT_SECRET') || DEFAULT_CONFIG.googleClientSecret,\n        githubClientId: env('GITHUB_CLIENT_ID') || DEFAULT_CONFIG.githubClientId,\n        githubClientSecret: env('GITHUB_CLIENT_SECRET') || DEFAULT_CONFIG.githubClientSecret,\n        oauthRedirectUri: env('OAUTH_REDIRECT_URI') || DEFAULT_CONFIG.oauthRedirectUri,\n\n        // CORS\n        corsOrigins: env('CORS_ORIGINS') || DEFAULT_CONFIG.corsOrigins,\n\n        // Ollama\n        ollamaBaseUrl: env('OLLAMA_BASE_URL') || DEFAULT_CONFIG.ollamaBaseUrl,\n        ollamaDefaultModel: env('OLLAMA_DEFAULT_MODEL') || DEFAULT_CONFIG.ollamaDefaultModel,\n        ollamaKoreanModel: env('OLLAMA_KOREAN_MODEL') || DEFAULT_CONFIG.ollamaKoreanModel,\n        ollamaModel: env('OLLAMA_MODEL') || DEFAULT_CONFIG.ollamaModel,\n        ollamaTimeout: parseInt(env('OLLAMA_TIMEOUT') || String(DEFAULT_CONFIG.ollamaTimeout), 10),\n        ollamaHost: env('OLLAMA_HOST') || DEFAULT_CONFIG.ollamaHost,\n        ollamaApiKey: env('OLLAMA_API_KEY') || DEFAULT_CONFIG.ollamaApiKey,\n        ollamaApiKeyPrimary: env('OLLAMA_API_KEY_PRIMARY') || DEFAULT_CONFIG.ollamaApiKeyPrimary,\n        ollamaApiKeySecondary: env('OLLAMA_API_KEY_SECONDARY') || DEFAULT_CONFIG.ollamaApiKeySecondary,\n        ollamaSshKey: env('OLLAMA_SSH_KEY') || DEFAULT_CONFIG.ollamaSshKey,\n\n        // Per-key models (OLLAMA_MODEL_1, _2, _3, ... N)\n        ollamaModels: (() => {\n            const models: string[] = [];\n            let index = 1;\n            while (true) {\n                const model = env(`OLLAMA_MODEL_${index}`);\n                if (model && model.trim() !== '') {\n                    models.push(model.trim());\n                    index++;\n                } else {\n                    break;\n                }\n            }\n            return models;\n        })(),\n\n        // Rate limits\n        ollamaHourlyLimit: parseInt(env('OLLAMA_HOURLY_LIMIT') || String(DEFAULT_CONFIG.ollamaHourlyLimit), 10),\n        ollamaWeeklyLimit: parseInt(env('OLLAMA_WEEKLY_LIMIT') || String(DEFAULT_CONFIG.ollamaWeeklyLimit), 10),\n        ollamaMonthlyPremiumLimit: parseInt(env('OLLAMA_MONTHLY_PREMIUM_LIMIT') || String(DEFAULT_CONFIG.ollamaMonthlyPremiumLimit), 10),\n\n        // Log\n        logLevel: parseLogLevel(env('LOG_LEVEL')),\n\n        // Gemini\n        geminiThinkEnabled: (env('GEMINI_THINK_ENABLED') || 'true') === 'true',\n        geminiThinkLevel: (env('GEMINI_THINK_LEVEL') || 'high') as 'low' | 'medium' | 'high',\n        geminiNumCtx: parseInt(env('GEMINI_NUM_CTX') || '32768', 10),\n        geminiEmbeddingModel: env('GEMINI_EMBEDDING_MODEL') || DEFAULT_CONFIG.geminiEmbeddingModel,\n        geminiWebSearchEnabled: (env('GEMINI_WEB_SEARCH_ENABLED') || 'true') === 'true',\n\n        // External services\n        googleApiKey: env('GOOGLE_API_KEY') || DEFAULT_CONFIG.googleApiKey,\n        googleCseId: env('GOOGLE_CSE_ID') || DEFAULT_CONFIG.googleCseId,\n        firecrawlApiKey: env('FIRECRAWL_API_KEY') || DEFAULT_CONFIG.firecrawlApiKey,\n        firecrawlApiUrl: env('FIRECRAWL_API_URL') || DEFAULT_CONFIG.firecrawlApiUrl,\n\n        // Documents\n        documentTtlHours: parseInt(env('DOCUMENT_TTL_HOURS') || String(DEFAULT_CONFIG.documentTtlHours), 10),\n        maxUploadedDocuments: parseInt(env('MAX_UPLOADED_DOCUMENTS') || String(DEFAULT_CONFIG.maxUploadedDocuments), 10),\n\n        // Conversations\n        maxConversationSessions: parseInt(env('MAX_CONVERSATION_SESSIONS') || String(DEFAULT_CONFIG.maxConversationSessions), 10),\n        sessionTtlDays: parseInt(env('SESSION_TTL_DAYS') || String(DEFAULT_CONFIG.sessionTtlDays), 10),\n\n        // User data\n        userDataPath: env('USER_DATA_PATH') || DEFAULT_CONFIG.userDataPath,\n\n        // VAPID\n        vapidPublicKey: env('VAPID_PUBLIC_KEY') || DEFAULT_CONFIG.vapidPublicKey,\n        vapidPrivateKey: env('VAPID_PRIVATE_KEY') || DEFAULT_CONFIG.vapidPrivateKey,\n        vapidSubject: env('VAPID_SUBJECT') || DEFAULT_CONFIG.vapidSubject,\n\n        // Swagger\n        swaggerBaseUrl: env('SWAGGER_BASE_URL') || DEFAULT_CONFIG.swaggerBaseUrl,\n    };\n}\n\n// 싱글톤 설정 인스턴스\nlet cachedConfig: EnvConfig | null = null;\n\nexport function getConfig(): EnvConfig {\n    if (!cachedConfig) {\n        cachedConfig = loadConfig();\n        // 설정 검증\n        validateConfig(cachedConfig);\n    }\n    return cachedConfig;\n}\n\nexport function resetConfig(): void {\n    cachedConfig = null;\n}\n"],"version":3}