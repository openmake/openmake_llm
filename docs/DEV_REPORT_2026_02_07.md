# OpenMake LLM Development Report (2026-02-07)

## 1. Overview
This report summarizes the code review and cleanup activities performed on the `openmake_llm` project. The focus was on identifying Ollama LLM integration patterns, removing unnecessary root-level files, and understanding the project structure.

## 2. Code Review Findings

### 2.1 Architecture
- **Backend**: Node.js/Express with TypeScript (`backend/api`).
- **Frontend**: Vanilla JavaScript (`frontend/web`).
- **Database**: PostgreSQL.
- **Service Integration**: Strong decoupling between API handling and LLM logic.

### 2.2 Ollama LLM Integration
The project uses a sophisticated wrapper around the standard Ollama API.

*   **Client Implementation**: `backend/api/src/ollama/client.ts`
    *   **Cloud Support**: Explicit support for "Cloud Models" (suffix `:cloud`). These requests are routed to `https://ollama.com` instead of the local instance.
    *   **Default Model**: The environment configuration (`backend/api/src/config/env.ts`) sets `gemini-3-flash-preview:cloud` as the default. This suggests the project is configured to use a cloud-hosted Gemini model via an Ollama-compatible interface by default.
    *   **Agent Loop**: `backend/api/src/ollama/agent-loop.ts` implements a multi-turn agent loop that handles Tool Calling and Streaming responses efficiently.

*   **Service Layer**: `backend/api/src/services/ChatService.ts`
    *   Orchestrates the conversation flow.
    *   Integrates **Document Context**, **Web Search**, and **Memory** before sending requests to Ollama.
    *   Uses a "Discussion Engine" for multi-agent scenarios.

### 2.3 Frontend Structure
*   **Model Agnostic**: The frontend (`chat.js`, `settings.js`) does not hardcode model names. It fetches available models from `/api/model` or uses the user's selection.
*   **Auto-generated Modules**: Many page modules in `frontend/web/public/js/modules/pages/` (e.g., `agent-learning.js`) contain the header `Auto-generated from [page].html`.
    *   **Recommendation**: Do not manually edit these files. Modifications should likely be made in source HTML/templates and re-compiled (likely via `scripts/generate-spa-modules.js`).

## 3. Cleanup Actions

The following files were identified as unnecessary for the standard execution flow (npm start) or were deprecated/temporary, and have been moved to the `/bak` directory:

| File | Reason for Removal |
|------|-------------------|
| `server.js` (Root) | Redundant. `package.json` defines `npm start` to use `backend/api/dist/server.js`. The root script appeared to be a legacy or manual cluster launcher. |
| `ecosystem.config.js` | Deprecated (File content explicitly stated PM2 is no longer used). |
| `test-agent-routing.js` | Temporary manual test script. |
| `test-mcp-routing.js` | Temporary manual test script. |

## 4. Recommendations

1.  **Execution**: Always use `npm start` or `npm run dev` to launch the application. Do not run `node server.js` from the root anymore.
2.  **Configuration**: Check `.env` or `backend/api/src/config/env.ts` if you wish to change the default model from `gemini-3-flash-preview:cloud` to a local Ollama model (e.g., `llama3`).
3.  **Frontend Development**: Be autious when editing files in `frontend/web/public/js/modules/pages/`. Verify if a build script needs to be run to regenerate them.

---
*Report generated by Sisyphus Agent*
